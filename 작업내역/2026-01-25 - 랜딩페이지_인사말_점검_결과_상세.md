# ëœë”©í˜ì´ì§€ ì¸ì‚¬ë§ ì ê²€ ê²°ê³¼ (ìƒì„¸)

## ğŸ” ì‹¤ì œ ë¬¸ì œ ìƒí™©

### í˜„ì¬ ì¸ì‚¬ë§ (MainPage.tsx:1603-1628)
```tsx
<p className="main-page__greeting-message">
  {ë³‘ì›ëª…}ì—ì„œ<br />
  ë” ì˜ë¯¸ìˆëŠ” ë‚´ì›ì´ ë˜ì‹œê¸¸ ë°”ë¼ë©°<br />
  ì¤€ë¹„í•œ ê±´ê°•ê´€ë¦¬ ì„œë¹„ìŠ¤ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!
</p>
```

### ë¬¸ì œ ì¼€ì´ìŠ¤

#### 1. ì§ˆë³‘ì˜ˆì¸¡ë¦¬í¬íŠ¸ì—ì„œ ë’¤ë¡œê°€ê¸°ë¡œ MainPage ì§„ì…
- **ê²½ë¡œ**: `/disease-report` â†’ ë’¤ë¡œê°€ê¸° â†’ `/?uuid=...&hospital=...`
- **í˜„ì¬ ë©”ì‹œì§€**: "ë” ì˜ë¯¸ìˆëŠ” ë‚´ì›ì´ ë˜ì‹œê¸¸ ë°”ë¼ë©°" âŒ
- **ë¬¸ì œ**: ì§ˆë³‘ì˜ˆì¸¡ë¦¬í¬íŠ¸ëŠ” ë³‘ì› ë°©ë¬¸ê³¼ ë¬´ê´€í•œ AI ë¶„ì„ ë¦¬í¬íŠ¸
- **ì˜¬ë°”ë¥¸ ë©”ì‹œì§€**: "ê±´ê°•í•œ ë¯¸ë˜ë¥¼ ìœ„í•œ AI ë¶„ì„ ë¦¬í¬íŠ¸ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!" ë“±

#### 2. ì¶”ì´ë³´ê¸°ì—ì„œ ë’¤ë¡œê°€ê¸°ë¡œ MainPage ì§„ì…
- **ê²½ë¡œ**: `/results-trend` â†’ ë’¤ë¡œê°€ê¸° â†’ `/?uuid=...&hospital=...`
- **í˜„ì¬ ë©”ì‹œì§€**: "ë” ì˜ë¯¸ìˆëŠ” ë‚´ì›ì´ ë˜ì‹œê¸¸ ë°”ë¼ë©°" âœ…
- **ì ì ˆí•¨**: ì¶”ì´ë³´ê¸°ëŠ” ë³‘ì› ë°©ë¬¸ í›„ ê±´ê°•ê²€ì§„ ê²°ê³¼ í™•ì¸

#### 3. ì²˜ìŒë¶€í„° MainPage ì§„ì… (ì¹´ë“œ í´ë¦­ ë“±)
- **ê²½ë¡œ**: ì§ì ‘ `/` ì ‘ê·¼ ë˜ëŠ” ì¹´ë“œ í´ë¦­
- **í˜„ì¬ ë©”ì‹œì§€**: "ë” ì˜ë¯¸ìˆëŠ” ë‚´ì›ì´ ë˜ì‹œê¸¸ ë°”ë¼ë©°" âœ…
- **ì ì ˆí•¨**: ê¸°ë³¸ ë©”ì‹œì§€

## ğŸ“‹ í˜„ì¬ redirect_path ì²˜ë¦¬ í˜„í™©

### 1. ì„¸ì…˜ ì‹œì‘ ì‹œ (useAuthFlow.ts:455)
```typescript
const redirectPath = urlParams.get('redirect') || urlParams.get('return_to') || null;
// ë°±ì—”ë“œ ì„¸ì…˜ì— ì €ì¥ë¨ (Redis)
```

### 2. AuthFormì—ì„œ ì‚¬ìš© (AuthForm.tsx:530)
```typescript
const redirectParam = urlParams.get('redirect');
const isDiseaseReport = redirectParam === '/disease-report';
// health_data_completed ì´ë²¤íŠ¸ ì²˜ë¦¬ ì‹œ ì‚¬ìš©
```

### 3. MainPageì—ì„œ í™•ì¸ âŒ
- **í˜„ì¬**: redirect_path í™•ì¸ ë¡œì§ ì—†ìŒ
- **ë¬¸ì œ**: MainPageì— ë„ë‹¬í•  ë•ŒëŠ” ì´ë¯¸ redirect íŒŒë¼ë¯¸í„°ê°€ URLì— ì—†ì„ ìˆ˜ ìˆìŒ

## ğŸ”§ í•´ê²° ë°©ì•ˆ

### ì˜µì…˜ 1: localStorageì— redirect_path ì €ì¥ (ê¶Œì¥)

#### 1-1. ì„¸ì…˜ ì‹œì‘ ì‹œ localStorageì— ì €ì¥
```typescript
// useAuthFlow.tsì—ì„œ
const redirectPath = urlParams.get('redirect') || urlParams.get('return_to') || null;
if (redirectPath) {
  StorageManager.setItem('welno_redirect_path', redirectPath);
}
```

#### 1-2. MainPageì—ì„œ localStorage í™•ì¸
```typescript
// MainPage.tsxì—ì„œ
const urlParams = new URLSearchParams(location.search);
const redirectParam = urlParams.get('redirect');
const savedRedirectPath = StorageManager.getItem('welno_redirect_path');
const redirectPath = redirectParam || savedRedirectPath;

const isDiseaseReport = redirectPath === '/disease-report' || 
                        location.pathname.includes('disease-report');
const isTrendView = redirectPath === '/results-trend' || 
                   redirectPath === '/chart' ||
                   location.pathname.includes('results-trend');
```

#### 1-3. ì¸ì‚¬ë§ ë¶„ê¸°
```tsx
<p className="main-page__greeting-message">
  {isKindHabitDomain ? (
    <>
      <span className="greeting-text">ì°©í•œìŠµê´€</span><span className="greeting-text">ì—ì„œ</span><br />
    </>
  ) : (
    <>
      <span className="hospital-name">{displayHospital.name}</span><span className="greeting-text">ì—ì„œ</span><br />
    </>
  )}
  {isDiseaseReport ? (
    <>
      <span className="greeting-text-thin">ê±´ê°•í•œ ë¯¸ë˜ë¥¼ ìœ„í•œ</span><br />
      <span className="greeting-text-thin">AI ë¶„ì„ ë¦¬í¬íŠ¸ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!</span>
    </>
  ) : (
    <>
      <span className="greeting-text-thin">ë” ì˜ë¯¸ìˆëŠ” ë‚´ì›ì´ ë˜ì‹œê¸¸ ë°”ë¼ë©°</span><br />
      <span className="greeting-text-thin">ì¤€ë¹„í•œ ê±´ê°•ê´€ë¦¬ ì„œë¹„ìŠ¤ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!</span>
    </>
  )}
</p>
```

### ì˜µì…˜ 2: ë¸Œë¼ìš°ì € íˆìŠ¤í† ë¦¬ ì¶”ì 
```typescript
// document.referrer í™•ì¸
const referrer = document.referrer;
const isFromDiseaseReport = referrer.includes('/disease-report');
const isFromTrendView = referrer.includes('/results-trend');
```
- **ë‹¨ì **: ë¸Œë¼ìš°ì € ì„¤ì •ì— ë”°ë¼ referrerê°€ ì—†ì„ ìˆ˜ ìˆìŒ

### ì˜µì…˜ 3: URL íŒŒë¼ë¯¸í„°ë¡œ from ì¶”ê°€
```typescript
// DiseaseReportPageì—ì„œ ë’¤ë¡œê°€ê¸° ì‹œ
navigate(`/?uuid=${uuid}&hospital=${hospitalId}&from=disease-report`);

// ResultsTrendPageì—ì„œ ë’¤ë¡œê°€ê¸° ì‹œ
navigate(`/?uuid=${uuid}&hospital=${hospital}&from=trend-view`);
```
- **ë‹¨ì **: ëª¨ë“  ë’¤ë¡œê°€ê¸° ë¡œì§ ìˆ˜ì • í•„ìš”

## ğŸ¯ ê¶Œì¥ êµ¬í˜„

1. **localStorageì— redirect_path ì €ì¥** (ì„¸ì…˜ ì‹œì‘ ì‹œ)
2. **MainPageì—ì„œ localStorage í™•ì¸**
3. **ì¸ì‚¬ë§ ë©”ì‹œì§€ ë¶„ê¸°**
4. **ì •ë¦¬**: ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ì´ë™ ì‹œ redirect_path ì‚­ì œ (ì„ íƒ)

## ğŸ“ ì¶”ê°€ ê³ ë ¤ì‚¬í•­

1. **ì¹´ì¸ë“œí•´ë¹— ë„ë©”ì¸**: ë³„ë„ ë©”ì‹œì§€ ìœ ì§€
2. **ë‹¤ë¥¸ ì§„ì… ê²½ë¡œ**: ê²€ì§„ì„¤ê³„, ì²˜ë°©ì „ ë“±ë„ ê³ ë ¤
3. **ë©”ì‹œì§€ ë¬¸êµ¬**: ì‚¬ìš©ì í™•ì¸ í•„ìš”
