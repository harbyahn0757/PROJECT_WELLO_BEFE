# ì§ˆë³‘ì˜ˆì¸¡ ë¦¬í¬íŠ¸ í™”ë©´ ì™„ì „ ê°€ì´ë“œ

**ìƒì„±ì¼**: 2026-01-31  
**ì‘ì—…ì¼ì**: 2026-01-31  
**ì‘ì—…ë‚´ìš©**: ì§ˆë³‘ì˜ˆì¸¡ ë¦¬í¬íŠ¸ í™”ë©´ ì™„ì „ ê°€ì´ë“œ (ê°œë°œìÂ·ê¸°íšÂ·QA)

> ì‘ì„±ì: AI Assistant  
> ëŒ€ìƒ: ê°œë°œì, ê¸°íšì, QA

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš” ë° ì§„ì…ì ](#1-ê°œìš”-ë°-ì§„ì…ì )
2. [ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°](#2-ì»´í¬ë„ŒíŠ¸-êµ¬ì¡°)
3. [ë°ì´í„° êµ¬ì¡° ë° API](#3-ë°ì´í„°-êµ¬ì¡°-ë°-api)
4. [ë¦¬í¬íŠ¸ ì„¹ì…˜ ìƒì„¸](#4-ë¦¬í¬íŠ¸-ì„¹ì…˜-ìƒì„¸)
5. [UI ì»´í¬ë„ŒíŠ¸ ìƒì„¸](#5-ui-ì»´í¬ë„ŒíŠ¸-ìƒì„¸)
6. [ìƒíƒœ ê´€ë¦¬](#6-ìƒíƒœ-ê´€ë¦¬)
7. [ìŠ¤íƒ€ì¼ë§ ë° í…Œë§ˆ](#7-ìŠ¤íƒ€ì¼ë§-ë°-í…Œë§ˆ)
8. [ë°ì´í„° íë¦„](#8-ë°ì´í„°-íë¦„)
9. [íŒŒì¼ êµ¬ì¡° ë° ê²½ë¡œ](#9-íŒŒì¼-êµ¬ì¡°-ë°-ê²½ë¡œ)
10. [ì½”ë“œ ì˜ˆì‹œ ë° êµ¬í˜„](#10-ì½”ë“œ-ì˜ˆì‹œ-ë°-êµ¬í˜„)

---

## 1. ê°œìš” ë° ì§„ì…ì 

### 1.1 ë¦¬í¬íŠ¸ í™”ë©´ ëª©ì 

ì§ˆë³‘ì˜ˆì¸¡ ë¦¬í¬íŠ¸ í™”ë©´(`DiseaseReportPage`)ì€ ì‚¬ìš©ìì˜ ê±´ê°•ê²€ì§„ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±ëœ ì§ˆë³‘/ì•” ì˜ˆì¸¡ ë¦¬í¬íŠ¸ë¥¼ ì‹œê°í™”í•˜ì—¬ ë³´ì—¬ì£¼ëŠ” í˜ì´ì§€ì…ë‹ˆë‹¤.

**ì£¼ìš” ê¸°ëŠ¥:**
- ê±´ê°•ë‚˜ì´(bodyage) vs ê²€ì§„ë‚˜ì´ ë¹„êµ
- ë™ì¼ ì—°ë ¹ëŒ€ ëŒ€ë¹„ ê±´ê°• ë“±ìˆ˜ í‘œì‹œ
- ì§ˆë³‘/ì•” ë°œë³‘ í™•ë¥  ì‹œê°í™”
- ì§ˆë³‘/ì•” ìƒì„¸ ì •ë³´ ì œê³µ (ì¹´ë“œ ìŠ¬ë¼ì´ë”)
- PDF ë‹¤ìš´ë¡œë“œ ë° ê³µìœ  ê¸°ëŠ¥

### 1.2 URL íŒ¨í„´ ë° íŒŒë¼ë¯¸í„°

**ê¸°ë³¸ ê²½ë¡œ**: `/disease-report`

**URL íŒŒë¼ë¯¸í„° (4ê°€ì§€ ì¼€ì´ìŠ¤):**

| íŒŒë¼ë¯¸í„° | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… | ì‚¬ìš© ì¼€ì´ìŠ¤ |
|---------|------|------|------|------------|
| `uuid` | string | ì„ íƒ | í™˜ì UUID | WELNO ì§ì ‘ ì ‘ê·¼ |
| `hospital_id` ë˜ëŠ” `hospital` | string | ì„ íƒ | ë³‘ì› ID | WELNO ì§ì ‘ ì ‘ê·¼ |
| `oid` | string | ì„ íƒ | íŒŒíŠ¸ë„ˆ ê²°ì œ ì£¼ë¬¸ë²ˆí˜¸ | íŒŒíŠ¸ë„ˆ ìº í˜ì¸ |
| `partner` | string | ì„ íƒ | íŒŒíŠ¸ë„ˆ ID | íŒŒíŠ¸ë„ˆ ìº í˜ì¸ |
| `sessionId` | string | ì„ íƒ | WebSocket ì„¸ì…˜ ID | ì‹¤ì‹œê°„ ìƒì„± ëª¨ë‹ˆí„°ë§ |
| `generate` | string | ì„ íƒ | `'true'` ì‹œ ë¦¬í¬íŠ¸ ìƒì„± | ìƒì„± íŠ¸ë¦¬ê±° |

**URL ì˜ˆì‹œ:**

```bash
# WELNO ì§ì ‘ ì ‘ê·¼
/disease-report?uuid=abc123&hospital_id=PEERNINE

# íŒŒíŠ¸ë„ˆ ìº í˜ì¸ (ê²°ì œ ì™„ë£Œ)
/disease-report?oid=COCkkhabit_1737712345678&partner=kindhabit

# ë¦¬í¬íŠ¸ ìƒì„± íŠ¸ë¦¬ê±°
/disease-report?uuid=abc123&hospital_id=PEERNINE&generate=true&sessionId=session_123
```

### 1.3 ë¼ìš°íŒ… ì„¤ì •

**íŒŒì¼ ìœ„ì¹˜**: `planning-platform/frontend/src/App.tsx` (524ë²ˆì§¸ ì¤„)

```tsx
<Route path="/disease-report" element={<DiseaseReportPage />} />
```

### 1.4 ì§„ì… ê²½ë¡œ

1. **MainPageì—ì„œ ë¦¬í¬íŠ¸ ë²„íŠ¼ í´ë¦­**
   - í™˜ì ì •ë³´ í™•ì¸ í›„ ë¦¬í¬íŠ¸ ì¡´ì¬ ì‹œ ìë™ ì´ë™
   - URL: `/disease-report?uuid={uuid}&hospital_id={hospital_id}`

2. **ìº í˜ì¸ í˜ì´ì§€ì—ì„œ ë¦¬í¬íŠ¸ ìƒì„± ì™„ë£Œ í›„**
   - ê²°ì œ ì™„ë£Œ â†’ ë¦¬í¬íŠ¸ ìƒì„± ì™„ë£Œ â†’ ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸
   - URL: `/disease-report?oid={oid}&partner={partner_id}`

3. **ì§ì ‘ URL ì ‘ê·¼**
   - ë¶ë§ˆí¬, ê³µìœ  ë§í¬ ë“±
   - URL íŒŒë¼ë¯¸í„°ë¡œ í™˜ì ì‹ë³„

---

## 2. ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

### 2.1 ì „ì²´ ê³„ì¸µ êµ¬ì¡° (Mermaid ë‹¤ì´ì–´ê·¸ë¨)

```mermaid
graph TD
    A[DiseaseReportPage] --> B[Hooks]
    A --> C[Header]
    A --> D[Content]
    A --> E[Modals]
    
    B --> B1[useUnifiedStatus]
    B --> B2[useMatrixAutoRedirect]
    B --> B3[useFloatingButton]
    B --> B4[useWebSocketAuth]
    B --> B5[useCampaignSkin]
    
    C --> C1[ë’¤ë¡œê°€ê¸° ë²„íŠ¼]
    C --> C2[ë¦¬í¬íŠ¸ ì œëª©]
    C --> C3[ìƒ‰ìƒ ëª¨ë“œ í† ê¸€]
    C --> C4[ë‹¤ìš´ë¡œë“œ/ê³µìœ  ë²„íŠ¼]
    C --> C5[ì—…ë°ì´íŠ¸ ì‹œê°„]
    
    D --> D1[HealthAgeSection<br/>ê±´ê°•ë‚˜ì´]
    D --> D2[RankSection<br/>ë“±ìˆ˜]
    D --> D3[ProbabilitySection<br/>ë°œë³‘í™•ë¥ ]
    D --> D4[DiseasesSection<br/>ì§ˆë³‘/ì•” ë¦¬ìŠ¤íŠ¸]
    
    D1 --> D1A[ê²€ì§„ë‚˜ì´ ë°•ìŠ¤]
    D1 --> D1B[í™”ì‚´í‘œ]
    D1 --> D1C[ê±´ê°•ë‚˜ì´ ë°•ìŠ¤]
    D1 --> D1D[ë¹„êµ ë©”ì‹œì§€]
    
    D2 --> D2A[ë‚´ ê±´ê°•ë‚˜ì´ ë“±ìˆ˜<br/>ë©”ì¸]
    D2 --> D2B[ì¢‹ì€ í•­ëª© 2ê°œ<br/>ğŸ¥‡ğŸ¥ˆ]
    D2 --> D2C[êµ¬ë¶„ì„ ]
    D2 --> D2D[ë‚˜ìœ í•­ëª© 2ê°œ<br/>âš ï¸]
    
    D3 --> D3A[ìš”ì•½ ë©”ì‹œì§€]
    D3 --> D3B[ì›í˜• ì°¨íŠ¸ 2x2<br/>ìƒìœ„ 4ê°œ]
    
    D4 --> D4A[CancerSection<br/>ì•”]
    D4 --> D4B[DiseaseSection<br/>ì§ˆë³‘]
    
    D4A --> D4A1[í•„í„° ë²„íŠ¼]
    D4A --> D4A2[ìŠ¬ë¼ì´ë” ì¹´ë“œ]
    D4A --> D4A3[ë„íŠ¸ ì¸ë””ì¼€ì´í„°]
    
    D4B --> D4B1[í•„í„° ë²„íŠ¼]
    D4B --> D4B2[ìŠ¬ë¼ì´ë” ì¹´ë“œ]
    D4B --> D4B3[ë„íŠ¸ ì¸ë””ì¼€ì´í„°]
    
    E --> E1[DebugDeleteModal]
    E --> E2[EmailInputModal]
```

### 2.2 ì»´í¬ë„ŒíŠ¸ íŒŒì¼ êµ¬ì¡°

```
planning-platform/frontend/src/features/disease-report/
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ DiseaseReportPage.tsx           # ë©”ì¸ ì»´í¬ë„ŒíŠ¸ (2157ì¤„)
â”‚       â””â”€â”€ hooks/
â”‚           â”œâ”€â”€ useMatrixAutoRedirect.ts  # ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë¡œì§
â”‚           â””â”€â”€ useFloatingButton.ts      # í”Œë¡œíŒ… ë²„íŠ¼ ì œì–´
â”‚
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useUnifiedStatus.ts             # í†µí•© ìƒíƒœ ê´€ë¦¬ (ë°±ì—”ë“œ ê¸°ë°˜)
â”‚   â”œâ”€â”€ useCampaignSkin.ts              # í…Œë§ˆ ê´€ë¦¬ (ê¸°ë³¸/ë¸Œë¼ìš´)
â”‚   â””â”€â”€ useAIMSReportPolling.ts         # ë¦¬í¬íŠ¸ ìƒì„± í´ë§
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ DebugDeleteModal.tsx            # ë””ë²„ê·¸ ëª¨ë“œ ì‚­ì œ ëª¨ë‹¬
â”‚   â””â”€â”€ ReportActionModal.tsx           # ë¦¬í¬íŠ¸ ì•¡ì…˜ ëª¨ë‹¬
â”‚
â”œâ”€â”€ types/
â”‚   â”œâ”€â”€ aimsReport.ts                   # ë¦¬í¬íŠ¸ ë°ì´í„° íƒ€ì… ì •ì˜
â”‚   â””â”€â”€ index.ts                        # ê¸°íƒ€ íƒ€ì… ì •ì˜
â”‚
â”œâ”€â”€ styles/
â”‚   â”œâ”€â”€ aims-report.scss                # ë©”ì¸ ë¦¬í¬íŠ¸ ìŠ¤íƒ€ì¼ (1662ì¤„)
â”‚   â”œâ”€â”€ campaign.scss                   # ìº í˜ì¸ ìŠ¤íƒ€ì¼
â”‚   â”œâ”€â”€ campaign-fixed.scss             # ê³ ì • ìš”ì†Œ ìŠ¤íƒ€ì¼
â”‚   â””â”€â”€ debug-delete-modal.scss         # ë””ë²„ê·¸ ëª¨ë‹¬ ìŠ¤íƒ€ì¼
â”‚
â””â”€â”€ utils/
    â”œâ”€â”€ ageCalculator.ts                # ë‚˜ì´ ê³„ì‚° ìœ í‹¸
    â”œâ”€â”€ gtm.ts                          # Google Tag Manager ì¶”ì 
    â””â”€â”€ legacyCompat.ts                 # ë ˆê±°ì‹œ í˜¸í™˜ì„± í•¨ìˆ˜
```

### 2.3 ì£¼ìš” Hooks

| Hook | íŒŒì¼ ìœ„ì¹˜ | ìš©ë„ |
|------|----------|------|
| `useUnifiedStatus` | `hooks/useUnifiedStatus.ts` | ë°±ì—”ë“œ ê¸°ë°˜ í†µí•© ìƒíƒœ ê´€ë¦¬ (ì•½ê´€/ê²°ì œ/ë°ì´í„°/ë¦¬í¬íŠ¸) |
| `useMatrixAutoRedirect` | `pages/DiseaseReportPage/hooks/useMatrixAutoRedirect.ts` | ìƒíƒœì— ë”°ë¥¸ ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸ (ì•½ê´€, ê²°ì œ, ë°ì´í„° ìˆ˜ì§‘) |
| `useFloatingButton` | `pages/DiseaseReportPage/hooks/useFloatingButton.ts` | í”Œë¡œíŒ… ë²„íŠ¼ í‘œì‹œ ì œì–´ |
| `useWebSocketAuth` | `hooks/useWebSocketAuth.ts` | Tilko ì¸ì¦ ì„¸ì…˜ WebSocket ì—°ê²° |
| `useCampaignSkin` | `hooks/useCampaignSkin.ts` | ìŠ¤í‚¨ ëª¨ë“œ ê´€ë¦¬ (G: ê¸°ë³¸, Br: ë¸Œë¼ìš´) |

---

## 3. ë°ì´í„° êµ¬ì¡° ë° API

### 3.1 API ì—”ë“œí¬ì¸íŠ¸ (2ê°€ì§€)

#### 3.1.1 WELNO ì¼€ì´ìŠ¤ (ì§ì ‘ ì ‘ê·¼)

**ì—”ë“œí¬ì¸íŠ¸**: `GET /api/v1/welno/mediarc-report`

**ìš”ì²­ íŒŒë¼ë¯¸í„°**:
```typescript
{
  uuid: string,        // í™˜ì UUID
  hospital_id: string  // ë³‘ì› ID
}
```

**ì‘ë‹µ êµ¬ì¡°**:
```json
{
  "success": true,
  "has_report": true,
  "data": {
    "bodyage": 63,
    "rank": 51,
    "report_url": "https://kr.ncloudstorage.com/.../report.pdf",
    "disease_data": [...],
    "cancer_data": [...],
    "updated_at": "2026-01-31T12:34:56"
  }
}
```

#### 3.1.2 íŒŒíŠ¸ë„ˆ ì¼€ì´ìŠ¤ (ìº í˜ì¸)

**ì—”ë“œí¬ì¸íŠ¸**: `GET /api/v1/campaigns/disease-prediction/report`

**ìš”ì²­ íŒŒë¼ë¯¸í„°**:
```typescript
{
  oid: string  // ì£¼ë¬¸ë²ˆí˜¸
}
```

**ì‘ë‹µ êµ¬ì¡°**:
```json
{
  "success": true,
  "oid": "COCkkhabit_1737712345678",
  "status": "completed",
  "report_url": "https://kr.ncloudstorage.com/.../report.pdf",
  "error_message": null,
  "updated_at": "2026-01-31T12:34:56",
  "mediarc_response": {
    "bodyage": 63,
    "rank": 51,
    "disease_data": [...],
    "cancer_data": [...]
  },
  "user_name": "í™ê¸¸ë™"
}
```

**ì—ëŸ¬ ì‘ë‹µ (ë¦¬í¬íŠ¸ ìƒì„± ì‹¤íŒ¨)**:
```json
{
  "success": false,
  "oid": "COCkkhabit_1737712345678",
  "status": "REPORT_FAILED",
  "error_message": "ë¦¬í¬íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤...",
  "updated_at": "2026-01-31T12:34:56",
  "user_name": "í™ê¸¸ë™",
  "should_redirect_to_landing": true
}
```

### 3.2 mediarc_response ìƒì„¸ êµ¬ì¡°

#### 3.2.1 ì „ì²´ êµ¬ì¡° í‘œ

| í•„ë“œ | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|------|------|
| `bodyage` | number | âœ… | ê±´ê°•ë‚˜ì´ (ì²´ì§ˆë‚˜ì´) | `63` |
| `rank` | number | âœ… | ë™ì¼ ì—°ë ¹ëŒ€ ëŒ€ë¹„ ë“±ìˆ˜ (100ëª… ì¤‘) | `51` |
| `disease_data` | array | âœ… | ì§ˆë³‘ ì˜ˆì¸¡ ê²°ê³¼ ë°°ì—´ | `[...]` |
| `cancer_data` | array | âœ… | ì•” ì˜ˆì¸¡ ê²°ê³¼ ë°°ì—´ | `[...]` |
| `report_url` | string | ì„ íƒ | PDF ë¦¬í¬íŠ¸ S3 URL | `https://...` |
| `provider` | string | ì„ íƒ | ì œê³µì | `"twobecon"` |
| `analyzed_at` | string | ì„ íƒ | ë¶„ì„ ì™„ë£Œ ì‹œê° (ISO 8601) | `"2026-01-23T12:34:56"` |

#### 3.2.2 disease_data ë°°ì—´ êµ¬ì¡°

ê° í•­ëª©ì˜ íƒ€ì…:
```typescript
interface AIMSDataItem {
  name: string;           // ì§ˆë³‘ëª… (ì˜ˆ: "ê³ í˜ˆì••")
  code: string;           // ì§ˆë³‘ ì½”ë“œ (ì˜ˆ: "hypertension")
  type: 'disease';        // íƒ€ì… (í•­ìƒ "disease")
  label: 'NORMAL' | 'BOUNDARY' | 'ABNORMAL';  // íŒì • ë ˆì´ë¸”
  rank: number;           // ë“±ìˆ˜ (1~100)
  average: number;        // í‰ê·  ë°œë³‘ë¥  (%)
  rate: number;           // ì˜ˆìƒ ë°œë³‘ë¥  (%)
  influence: AIMSInfluence[] | null;  // ì˜í–¥ ìš”ì¸
}

interface AIMSInfluence {
  name: string;   // ì˜í–¥ ìš”ì¸ëª… (ì˜ˆ: "ìˆ˜ì¶•ê¸°í˜ˆì••")
  code: string;   // ì˜í–¥ ìš”ì¸ ì½”ë“œ (ì˜ˆ: "sbp")
  label: string;  // ì˜í–¥ ìš”ì¸ ë ˆì´ë¸” (ì˜ˆ: "ê²½ê³„")
}
```

**ì˜ˆì‹œ**:
```json
{
  "name": "ê³ í˜ˆì••",
  "code": "hypertension",
  "type": "disease",
  "label": "BOUNDARY",
  "rank": 81,
  "average": 33,
  "rate": 4.1,
  "influence": [
    {
      "name": "ìˆ˜ì¶•ê¸°í˜ˆì••",
      "code": "sbp",
      "label": "ê²½ê³„"
    }
  ]
}
```

#### 3.2.3 cancer_data ë°°ì—´ êµ¬ì¡°

êµ¬ì¡°ëŠ” `disease_data`ì™€ ë™ì¼í•˜ë©°, `type`ë§Œ `'cancer'`ë¡œ ë³€ê²½ë©ë‹ˆë‹¤.

**ì˜ˆì‹œ**:
```json
{
  "name": "ìœ„ì•”",
  "code": "stomach_cancer",
  "type": "cancer",
  "label": "NORMAL",
  "rank": 45,
  "average": 28,
  "rate": 2.3,
  "influence": null
}
```

### 3.3 í”„ë¡ íŠ¸ì—”ë“œ ë°ì´í„° ë³€í™˜

#### 3.3.1 AIMSResponse íƒ€ì… (í”„ë¡ íŠ¸ì—”ë“œ)

**íŒŒì¼ ìœ„ì¹˜**: `planning-platform/frontend/src/features/disease-report/types/aimsReport.ts`

```typescript
export interface AIMSResponse {
  bodyage: number;
  rank: number;
  data: AIMSDataItem[];  // disease + cancer í†µí•© ë°°ì—´
}
```

#### 3.3.2 ë°ì´í„° ë³€í™˜ ë¡œì§

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (474-483ì¤„, 559-567ì¤„)

**íŒŒíŠ¸ë„ˆ ì¼€ì´ìŠ¤**:
```typescript
const medarcResponse = data.mediarc_response || {};
const diseaseData = medarcResponse.disease_data || [];
const cancerData = medarcResponse.cancer_data || [];
const combinedData = [...diseaseData, ...cancerData];

const aimsData: AIMSResponse = {
  bodyage: medarcResponse.bodyage || 0,
  rank: medarcResponse.rank || 0,
  data: combinedData  // diseaseì™€ cancerë¥¼ í•˜ë‚˜ì˜ ë°°ì—´ë¡œ í†µí•©
};
```

**WELNO ì¼€ì´ìŠ¤**:
```typescript
const diseaseData = data.data.disease_data || [];
const cancerData = data.data.cancer_data || [];
const combinedData = [...diseaseData, ...cancerData];

const aimsData: AIMSResponse = {
  bodyage: data.data.bodyage || 0,
  rank: data.data.rank || 0,
  data: combinedData
};
```

#### 3.3.3 ì •ë ¬ ë¡œì§

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (1367-1396ì¤„)

**ì •ë ¬ ìš°ì„ ìˆœìœ„**:
1. ë ˆì´ë¸” ìš°ì„ ìˆœìœ„: `ABNORMAL` > `BOUNDARY` > `NORMAL`
2. ê°™ì€ ë ˆì´ë¸” ë‚´: `rank` ë†’ì€ ìˆœ (ë‚´ë¦¼ì°¨ìˆœ)

**ì•” ë°ì´í„° í•„í„°ë§ ë° ì •ë ¬**:
```typescript
const filteredCancerData = reportData?.data
  ? [...reportData.data]
      .filter((item) => {
        if (item.type !== 'cancer') return false;
        if (cancerLabelFilter !== 'ALL' && normalizeLabel(item.label) !== cancerLabelFilter) return false;
        return true;
      })
      .sort((a, b) => {
        const labelOrder: Record<string, number> = { 'ABNORMAL': 3, 'BOUNDARY': 2, 'NORMAL': 1 };
        const orderDiff = (labelOrder[normalizeLabel(b.label)] || 0) - (labelOrder[normalizeLabel(a.label)] || 0);
        if (orderDiff !== 0) return orderDiff;
        return b.rank - a.rank;  // ê°™ì€ ë ˆì´ë¸”ì´ë©´ rank ë†’ì€ ìˆœ
      })
  : [];
```

**ì§ˆë³‘ ë°ì´í„° í•„í„°ë§ ë° ì •ë ¬**: ì•” ë°ì´í„°ì™€ ë™ì¼í•œ ë¡œì§

---

## 4. ë¦¬í¬íŠ¸ ì„¹ì…˜ ìƒì„¸

### 4.1 Header (í—¤ë”)

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (1548-1605ì¤„)

**êµ¬ì„± ìš”ì†Œ**:

| ìš”ì†Œ | ì„¤ëª… | ê¸°ëŠ¥ |
|------|------|------|
| ë’¤ë¡œê°€ê¸° ë²„íŠ¼ | `â†` ì•„ì´ì½˜ | `navigate(-1)` ì´ì „ í˜ì´ì§€ë¡œ ì´ë™ |
| ë¦¬í¬íŠ¸ ì œëª© | "ì§ˆë³‘ì˜ˆì¸¡ ë¦¬í¬íŠ¸" | í˜ì´ì§€ ì œëª© í‘œì‹œ |
| ìƒ‰ìƒ ëª¨ë“œ í† ê¸€ | ê¸°ë³¸/ë¸Œë¼ìš´ ì „í™˜ ë²„íŠ¼ | `changeSkin('G' | 'Br')` ìŠ¤í‚¨ ë³€ê²½ |
| ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ (ë°ìŠ¤í¬í†±) | "â¬‡ï¸ ë‹¤ìš´ë¡œë“œ" | `handleDownload()` PDF ë‹¤ìš´ë¡œë“œ |
| ê³µìœ  ë²„íŠ¼ (ëª¨ë°”ì¼) | "ğŸ“¤ ê³µìœ " | `handleShare()` Web Share API ë˜ëŠ” í´ë¦½ë³´ë“œ |
| ì—…ë°ì´íŠ¸ ì‹œê°„ | "ì—…ë°ì´íŠ¸: 2026-01-31..." | `reportUpdatedAt` í‘œì‹œ |

**ì½”ë“œ ì˜ˆì‹œ**:
```tsx
<header className="report-header">
  <div className="report-header-top">
    <button className="back-button" onClick={() => navigate(-1)}>
      â† ë’¤ë¡œ
    </button>
    <h1 className="report-title">ì§ˆë³‘ì˜ˆì¸¡ ë¦¬í¬íŠ¸</h1>
    <div className="report-header-actions">
      <button className="skin-toggle-button" onClick={() => handleSkinChange(isBrownMode ? 'default' : 'brown')}>
        {isBrownMode ? 'ê¸°ë³¸ ëª¨ë“œ' : 'ë¸Œë¼ìš´ ëª¨ë“œ'}
      </button>
    </div>
  </div>
  <div className="report-header-bottom">
    {!isMobile ? (
      <button className="report-action-button download-button" onClick={handleDownload}>
        â¬‡ï¸ ë‹¤ìš´ë¡œë“œ
      </button>
    ) : (
      <button className="report-action-button share-button" onClick={handleShare}>
        ğŸ“¤ ê³µìœ 
      </button>
    )}
    {reportUpdatedAt && (
      <div className="report-update-time">
        ì—…ë°ì´íŠ¸: {reportUpdatedAt}
      </div>
    )}
  </div>
</header>
```

### 4.2 HealthAgeSection (ê±´ê°•ë‚˜ì´ ì„¹ì…˜)

**íŒŒì¼ ìœ„ì¹˜**: 
- ì»´í¬ë„ŒíŠ¸: `components/health/HealthAgeSection/index.tsx`
- ì‚¬ìš©: `DiseaseReportPage.tsx` (1631-1638ì¤„)

**êµ¬ì„± ìš”ì†Œ**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì‹¤ì œ ë‚˜ì´ë³´ë‹¤ ê±´ê°•ë‚˜ì´ê°€ 1.5ì„¸ ë†’ìŠµë‹ˆë‹¤   â”‚  â† ë¹„êµ ë©”ì‹œì§€
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â†’    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚ â”‚ê²€ì§„ë‚˜ì´ â”‚  í™”ì‚´í‘œ  â”‚ê±´ê°•ë‚˜ì´ â”‚          â”‚
â”‚ â”‚  61ì„¸  â”‚    â†’    â”‚ 62.5ì„¸ â”‚          â”‚  â† ë‚˜ì´ ë°•ìŠ¤ë“¤
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Props**:
```typescript
interface HealthAgeSectionProps {
  healthAge: number;           // ê±´ê°•ë‚˜ì´ (bodyage)
  actualAge: number | null;    // ê²€ì§„ë‚˜ì´ (ì‹¤ì œë‚˜ì´)
  variant?: 'default' | 'card'; // ë ˆì´ì•„ì›ƒ íƒ€ì…
  className?: string;
  showGlowEffect?: boolean;    // ë°˜ì§ì„ íš¨ê³¼
  onAgeClick?: () => void;     // í´ë¦­ í•¸ë“¤ëŸ¬ (ë””ë²„ê·¸ ëª¨ë“œ)
  compact?: boolean;
  showBorder?: boolean;
}
```

**íŠ¹ìˆ˜ ê¸°ëŠ¥**:
- **ë°˜ì§ì„ íš¨ê³¼**: `showGlowEffect={true}` ì‹œ `glow-effect` í´ë˜ìŠ¤ ì¶”ê°€
- **ë””ë²„ê·¸ ëª¨ë‹¬**: ë‚˜ì´ ë°•ìŠ¤ 3íšŒ ì—°ì† í´ë¦­ ì‹œ `DebugDeleteModal` í‘œì‹œ

**ì½”ë“œ ì˜ˆì‹œ** (ì‚¬ìš©):
```tsx
<HealthAgeSection
  healthAge={reportData.bodyage}
  actualAge={currentAge}
  variant="card"
  showGlowEffect={showAgeCardGlow}
  onAgeClick={handleAgeBoxClick}
/>
```

### 4.3 RankSection (ë“±ìˆ˜ ì„¹ì…˜)

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (1674-1750ì¤„)

**êµ¬ì„± ìš”ì†Œ**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë‚´ ê±´ê°•ë‚˜ì´ ë“±ìˆ˜                          â”‚  â† ì„¹ì…˜ ì œëª©
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ˜Š  ë‹¹ì‹ ì˜ ê±´ê°•ë‚˜ì´ëŠ” 51ë“± ì…ë‹ˆë‹¤         â”‚  â† ë©”ì¸ ë“±ìˆ˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ¥‡  ì½œë ˆìŠ¤í…Œë¡¤       30ë“±                â”‚  â† ì¢‹ì€ í•­ëª© 1
â”‚ ğŸ¥ˆ  í˜ˆë‹¹            45ë“±                â”‚  â† ì¢‹ì€ í•­ëª© 2
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â† êµ¬ë¶„ì„ 
â”‚ âš ï¸  í˜ˆì••            65ë“±                â”‚  â† ë‚˜ìœ í•­ëª© 1
â”‚ âš ï¸  ê°„ê¸°ëŠ¥          72ë“±                â”‚  â† ë‚˜ìœ í•­ëª© 2
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ë¡œì§**:

1. **ë©”ì¸ ë“±ìˆ˜ ì´ëª¨ì§€**:
   ```typescript
   const rankEmoji = reportData.rank <= 10 ? 'ğŸ˜Š' : reportData.rank <= 50 ? 'ğŸ˜Š' : 'ğŸ˜¢';
   ```

2. **ì¢‹ì€ í•­ëª© (ìƒìœ„ 2ê°œ)**:
   - ì¡°ê±´: `item.rank < reportData.rank && item.rank <= 50`
   - ì •ë ¬: `rank` ë‚®ì€ ìˆœ (ë“±ìˆ˜ê°€ ì¢‹ì€ ìˆœ)
   - ì´ëª¨ì§€: 1ìœ„ ğŸ¥‡, 2ìœ„ ğŸ¥ˆ

3. **ë‚˜ìœ í•­ëª© (ìƒìœ„ 2ê°œ)**:
   - ì¡°ê±´: `item.rank > reportData.rank`
   - ì •ë ¬: `rank` ë‚®ì€ ìˆœ (ëœ ë‚˜ìœ ìˆœ)
   - ì´ëª¨ì§€: âš ï¸

**ì½”ë“œ ì˜ˆì‹œ**:
```tsx
{/* ì¢‹ì€ ê²ƒ 2ê°œ: 50ë“± ì´í•˜ê°€ ìˆìœ¼ë©´ ë³´ì—¬ì£¼ê¸° */}
{(() => {
  const goodItems = sortedData
    .filter(item => item.rank < reportData.rank && item.rank <= 50)
    .sort((a, b) => a.rank - b.rank)
    .slice(0, 2);

  if (goodItems.length > 0) {
    return goodItems.map((item, idx) => (
      <div key={item.code} className="rank-item rank-item-good">
        <div className="rank-icon">{idx === 0 ? 'ğŸ¥‡' : 'ğŸ¥ˆ'}</div>
        <div className="rank-info">
          <span className="rank-label">{item.name}</span>
          <span className="rank-value">{item.rank}ë“±</span>
        </div>
      </div>
    ));
  }
})()}

{/* ë‚˜ìœ ê²ƒ 2ê°œ */}
{sortedData
  .filter(item => item.rank > reportData.rank)
  .sort((a, b) => a.rank - b.rank)
  .slice(0, 2)
  .map((item, idx) => (
    <div key={item.code} className="rank-item rank-item-bad">
      <div className="rank-icon">âš ï¸</div>
      <div className="rank-info">
        <span className="rank-label">{item.name}</span>
        <span className="rank-value">{item.rank}ë“±</span>
      </div>
    </div>
  ))}
```

### 4.4 ProbabilitySection (ë°œë³‘í™•ë¥  ì„¹ì…˜)

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (1752-1814ì¤„)

**êµ¬ì„± ìš”ì†Œ**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì£¼ìš”ì§ˆí™˜ ë°œë³‘í™•ë¥                           â”‚  â† ì„¹ì…˜ ì œëª©
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ê³ ê°ë‹˜ì€ ìµœê·¼ ê±´ê°•ê²€ì§„ì—ì„œ                 â”‚
â”‚ #ê³ í˜ˆì•• #ë‹¹ë‡¨ë³‘ #ê³ ì§€í˜ˆì¦ ì™¸ 5ê±´           â”‚  â† ìš”ì•½ ë©”ì‹œì§€
â”‚ ë°œë³‘í™•ë¥ ì´ ë‹¤ë¥¸ í™•ë¥ ë³´ë‹¤ ë†’ê²Œ ë‚˜ì™”ì–´ìš”.      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚ â”‚ 4.1% â”‚  â”‚ 3.5% â”‚                     â”‚  â† ì›í˜• ì°¨íŠ¸ 2x2
â”‚ â”‚ ê²½ê³„  â”‚  â”‚ ìœ„í—˜  â”‚                     â”‚
â”‚ â”‚ê³ í˜ˆì•• â”‚  â”‚ë‹¹ë‡¨ë³‘ â”‚                     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚ â”‚ 2.8% â”‚  â”‚ 2.1% â”‚                     â”‚
â”‚ â”‚ ì •ìƒ  â”‚  â”‚ ì •ìƒ  â”‚                     â”‚
â”‚ â”‚ê³ ì§€í˜ˆì¦â”‚  â”‚ ìœ„ì•”  â”‚                     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ìš”ì•½ ë©”ì‹œì§€ ë¡œì§**:
```typescript
<span className="disease-tags">
  {sortedData.slice(0, 3).map((item, idx) => (
    <React.Fragment key={item.code}>
      <span className="disease-tag">#{item.name}</span>
      {idx < Math.min(2, sortedData.length - 1) && ' '}
    </React.Fragment>
  ))}
  {sortedData.length > 3 && (
    <span className="disease-count"> ì™¸ {sortedData.length - 3}ê±´</span>
  )}
</span>
```

**ì›í˜• ì°¨íŠ¸ êµ¬í˜„**:
```tsx
<div className="probability-charts-grid">
  {sortedData.slice(0, 4).map((item) => {
    const percentage = Math.min(item.rate, 100);
    return (
      <div key={item.code} className="probability-chart">
        <div className="chart-circle">
          <svg className="chart-svg" viewBox="0 0 100 100">
            <circle className="chart-background" cx="50" cy="50" r="45" />
            <circle
              className="chart-progress"
              cx="50"
              cy="50"
              r="45"
              strokeDasharray={`${2 * Math.PI * 45}`}
              strokeDashoffset={`${2 * Math.PI * 45 * (1 - percentage / 100)}`}
              style={{ stroke: getLabelColor(item.label) }}
            />
          </svg>
          <div className="chart-text">
            <span className="chart-percentage">{percentage}%</span>
            <span className="chart-label">{getLabelText(item.label)}</span>
          </div>
        </div>
        <p className="chart-disease-name">{item.name}</p>
      </div>
    );
  })}
</div>
```

**ìƒ‰ìƒ ë§¤í•‘**:
```typescript
const getLabelColor = (label: string) => {
  switch (label) {
    case 'NORMAL':
    case 'ì •ìƒ':
      return 'var(--success)';
    case 'BOUNDARY':
    case 'ê²½ê³„':
    case 'ì´ìƒ':
      return 'var(--warning)';
    case 'ABNORMAL':
    case 'ìœ„í—˜':
      return 'var(--danger)';
    default:
      return 'var(--text-secondary)';
  }
};
```

### 4.5 DiseasesSection (ì§ˆë³‘/ì•” ë¦¬ìŠ¤íŠ¸ ì„¹ì…˜)

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (1816-2115ì¤„)

#### 4.5.1 CancerSection (ì•” ì„¹ì…˜)

**êµ¬ì„± ìš”ì†Œ**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì•”                                       â”‚  â† ì œëª©
â”‚ [ì „ì²´] [ì •ìƒ] [ê²½ê³„] [ì£¼ì˜]                â”‚  â† í•„í„° ë²„íŠ¼
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚        ìœ„í—˜ (ìš°ìƒë‹¨ ë±ƒì§€)             â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚        ìœ„ì•”                          â”‚ â”‚  â† ì¹´ë“œ 1
â”‚ â”‚        ì•” / ìœ„í—˜ë„ ìˆœìœ„: 72ìœ„         â”‚ â”‚
â”‚ â”‚        í‰ê·  ë°œë³‘ë¥ : 35% / ì˜ˆìƒ: 3.5% â”‚ â”‚
â”‚ â”‚        ì˜í–¥ ìš”ì¸: ê°€ì¡±ë ¥, ...         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚            â— â—‹ â—‹ â—‹                      â”‚  â† ë„íŠ¸ ì¸ë””ì¼€ì´í„°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í•„í„° ë¡œì§**:
```typescript
const [cancerLabelFilter, setCancerLabelFilter] = useState<'ALL' | 'NORMAL' | 'BOUNDARY' | 'ABNORMAL'>('ALL');

<button
  className={`label-filter ${cancerLabelFilter === 'ALL' ? 'active' : ''}`}
  onClick={() => {
    setCancerLabelFilter('ALL');
    setCancerSliderIndex(0);
  }}
>
  ì „ì²´
</button>
```

**ìŠ¬ë¼ì´ë” ì¹´ë“œ**:
```tsx
<div className="diseases-slider-container" ref={cancerSliderContainerRef}>
  <div 
    className="diseases-slider"
    style={{
      transform: getSliderTransform(cancerSliderIndex, cancerSliderContainerRef)
    }}
    onTouchStart={handleCancerTouchStart}
    onTouchMove={handleCancerTouchMove}
    onTouchEnd={handleCancerTouchEnd}
    onMouseDown={handleCancerMouseDown}
    onMouseMove={handleCancerMouseMove}
    onMouseUp={handleCancerMouseUp}
    onMouseLeave={handleCancerMouseUp}
  >
    {filteredCancerData.map((item, idx) => (
      <div key={item.code} className={`disease-card ${isAbnormal(item.label) ? 'glow-effect' : ''}`}>
        <div className="disease-label-badge" style={{ backgroundColor: getLabelColor(item.label) }}>
          {getLabelText(item.label)}
        </div>
        <div className="disease-header">
          <h3 className="disease-name">{item.name}</h3>
          <div className="disease-meta">
            <span className="disease-type">{getTypeText(item.type)}</span>
            <span className="disease-rank">ìœ„í—˜ë„ ìˆœìœ„: {item.rank}ìœ„</span>
          </div>
        </div>
        <div className="disease-stats">
          <div className="disease-stat">
            <span className="stat-label">í‰ê·  ë°œë³‘ë¥ </span>
            <span className="stat-value">{item.average}%</span>
          </div>
          <div className="disease-stat">
            <span className="stat-label">ì˜ˆìƒ ë°œë³‘ë¥ </span>
            <span className="stat-value">{item.rate}%</span>
          </div>
        </div>
        {item.influence && item.influence.length > 0 && (
          <div className="disease-influence">
            <h4 className="influence-title">ì˜í–¥ ìš”ì¸</h4>
            <ul className="influence-list">
              {item.influence.map((inf, infIdx) => (
                <li key={infIdx} className="influence-item">
                  {inf.name} ({inf.label})
                </li>
              ))}
            </ul>
          </div>
        )}
      </div>
    ))}
  </div>
</div>
```

**ë„íŠ¸ ì¸ë””ì¼€ì´í„°**:
```tsx
{filteredCancerData.length > 1 && (
  <div className="diseases-slider-dots">
    {filteredCancerData.map((_, idx) => (
      <div
        key={idx}
        className={`slider-dot ${idx === cancerSliderIndex ? 'active' : ''}`}
        onClick={() => setCancerSliderIndex(idx)}
      />
    ))}
  </div>
)}
```

#### 4.5.2 DiseaseSection (ì§ˆë³‘ ì„¹ì…˜)

êµ¬ì¡°ì™€ ë¡œì§ì€ CancerSectionê³¼ ë™ì¼í•˜ë©°, ë‹¤ìŒë§Œ ë³€ê²½ë©ë‹ˆë‹¤:
- í•„í„° ìƒíƒœ: `diseaseLabelFilter`
- ìŠ¬ë¼ì´ë” ì¸ë±ìŠ¤: `diseaseSliderIndex`
- ë°ì´í„°: `filteredDiseaseData`

---

## 5. UI ì»´í¬ë„ŒíŠ¸ ìƒì„¸

### 5.1 ì°¨íŠ¸ (SVG ê¸°ë°˜ ì»¤ìŠ¤í…€)

#### 5.1.1 ì›í˜• í”„ë¡œê·¸ë ˆìŠ¤ ì°¨íŠ¸

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (1776-1813ì¤„)

**êµ¬í˜„ ì›ë¦¬**:
- SVG `<circle>` ìš”ì†Œ ì‚¬ìš©
- `stroke-dasharray`ì™€ `stroke-dashoffset`ìœ¼ë¡œ ì§„í–‰ë¥  í‘œí˜„

**ìˆ˜ì‹**:
```typescript
const circumference = 2 * Math.PI * radius;  // ì› ë‘˜ë ˆ
const strokeDasharray = circumference;       // ì „ì²´ ë‘˜ë ˆ
const strokeDashoffset = circumference * (1 - percentage / 100);  // ì§„í–‰ë¥ ì— ë”°ë¼ ì˜¤í”„ì…‹
```

**ì½”ë“œ**:
```tsx
<svg className="chart-svg" viewBox="0 0 100 100">
  {/* ë°°ê²½ ì› */}
  <circle
    className="chart-background"
    cx="50"
    cy="50"
    r="45"
  />
  {/* ì§„í–‰ë¥  ì› */}
  <circle
    className="chart-progress"
    cx="50"
    cy="50"
    r="45"
    strokeDasharray={`${2 * Math.PI * 45}`}
    strokeDashoffset={`${2 * Math.PI * 45 * (1 - percentage / 100)}`}
    style={{ stroke: getLabelColor(item.label) }}
  />
</svg>
```

**ë°˜ì‘í˜• í¬ê¸°**:
```scss
.probability-chart {
  width: 140px;
  height: 140px;

  @media (max-width: 480px) {
    width: 120px;
    height: 120px;
  }
}
```

### 5.2 ì¹´ë“œ ì»´í¬ë„ŒíŠ¸

#### 5.2.1 ì§ˆë³‘/ì•” ì¹´ë“œ êµ¬ì¡°

**ë ˆì´ì•„ì›ƒ**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ìœ„í—˜] â†ìš°ìƒë‹¨ ë±ƒì§€           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ê³ í˜ˆì••                       â”‚  â† ì§ˆë³‘ëª…
â”‚ ì§ˆë³‘ / ìœ„í—˜ë„ ìˆœìœ„: 81ìœ„      â”‚  â† ë©”íƒ€ ì •ë³´
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ í‰ê·  ë°œë³‘ë¥ : 33%             â”‚  â† í†µê³„
â”‚ ì˜ˆìƒ ë°œë³‘ë¥ : 4.1%            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì˜í–¥ ìš”ì¸:                   â”‚  â† ì˜í–¥ ìš”ì¸
â”‚ â€¢ ìˆ˜ì¶•ê¸°í˜ˆì•• (ê²½ê³„)          â”‚
â”‚ â€¢ ì´ì™„ê¸°í˜ˆì•• (ì •ìƒ)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**CSS í´ë˜ìŠ¤**:
```scss
.disease-card {
  width: 100%;
  background: var(--report-panel-bg);
  border-radius: 16px;
  padding: 24px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  position: relative;

  &.glow-effect {
    animation: glow-pulse 2s ease-in-out infinite;
  }
}

.disease-label-badge {
  position: absolute;
  top: 16px;
  right: 16px;
  padding: 4px 12px;
  border-radius: 12px;
  color: white;
  font-size: 12px;
  font-weight: 600;
}
```

### 5.3 ìŠ¬ë¼ì´ë” (ìŠ¤ì™€ì´í”„ ì§€ì›)

#### 5.3.1 í„°ì¹˜/ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ ì²˜ë¦¬

**ìƒíƒœ ê´€ë¦¬**:
```typescript
const [cancerSliderIndex, setCancerSliderIndex] = useState(0);
const [cancerTouchStartX, setCancerTouchStartX] = useState<number | null>(null);
const [cancerTouchEndX, setCancerTouchEndX] = useState<number | null>(null);
const cancerSliderContainerRef = useRef<HTMLDivElement>(null);
```

**í„°ì¹˜ í•¸ë“¤ëŸ¬**:
```typescript
const handleCancerTouchStart = (e: React.TouchEvent) => {
  setCancerTouchStartX(e.targetTouches[0].clientX);
};

const handleCancerTouchMove = (e: React.TouchEvent) => {
  setCancerTouchEndX(e.targetTouches[0].clientX);
};

const handleCancerTouchEnd = () => {
  if (cancerTouchStartX === null || cancerTouchEndX === null) return;

  const diff = cancerTouchStartX - cancerTouchEndX;
  const threshold = 50; // ìµœì†Œ ìŠ¤ì™€ì´í”„ ê±°ë¦¬

  if (Math.abs(diff) > threshold) {
    if (diff > 0) {
      // ì™¼ìª½ ìŠ¤ì™€ì´í”„ (ë‹¤ìŒ)
      setCancerSliderIndex((prev) => Math.min(prev + 1, filteredCancerData.length - 1));
    } else {
      // ì˜¤ë¥¸ìª½ ìŠ¤ì™€ì´í”„ (ì´ì „)
      setCancerSliderIndex((prev) => Math.max(prev - 1, 0));
    }
  }

  setCancerTouchStartX(null);
  setCancerTouchEndX(null);
};
```

**ë§ˆìš°ìŠ¤ í•¸ë“¤ëŸ¬** (ë°ìŠ¤í¬í†±):
```typescript
const [cancerMouseStartX, setCancerMouseStartX] = useState<number | null>(null);
const [cancerMouseEndX, setCancerMouseEndX] = useState<number | null>(null);
const [cancerIsMouseDown, setCancerIsMouseDown] = useState(false);

const handleCancerMouseDown = (e: React.MouseEvent) => {
  setCancerIsMouseDown(true);
  setCancerMouseStartX(e.clientX);
};

const handleCancerMouseMove = (e: React.MouseEvent) => {
  if (!cancerIsMouseDown) return;
  setCancerMouseEndX(e.clientX);
};

const handleCancerMouseUp = () => {
  if (!cancerIsMouseDown) return;
  setCancerIsMouseDown(false);

  if (cancerMouseStartX === null || cancerMouseEndX === null) return;

  const diff = cancerMouseStartX - cancerMouseEndX;
  const threshold = 50;

  if (Math.abs(diff) > threshold) {
    if (diff > 0) {
      setCancerSliderIndex((prev) => Math.min(prev + 1, filteredCancerData.length - 1));
    } else {
      setCancerSliderIndex((prev) => Math.max(prev - 1, 0));
    }
  }

  setCancerMouseStartX(null);
  setCancerMouseEndX(null);
};
```

#### 5.3.2 Transform ê³„ì‚°

**í•¨ìˆ˜**:
```typescript
const getSliderTransform = (index: number, containerRef: React.RefObject<HTMLDivElement>) => {
  if (!containerRef.current) return 'translateX(0)';
  const containerWidth = containerRef.current.offsetWidth;
  const cardWidth = containerWidth;
  const gap = 16; // ì¹´ë“œ ê°„ê²©
  const offset = -(index * (cardWidth + gap));
  return `translateX(${offset}px)`;
};
```

**ì ìš©**:
```tsx
<div 
  className="diseases-slider"
  style={{
    transform: getSliderTransform(cancerSliderIndex, cancerSliderContainerRef)
  }}
>
  {/* ì¹´ë“œë“¤ */}
</div>
```

**CSS**:
```scss
.diseases-slider {
  display: flex;
  gap: 16px;
  transition: transform 0.3s ease-out;
}
```

### 5.4 ì¸í„°ë™ì…˜ ìš”ì†Œ

#### 5.4.1 PDF ë‹¤ìš´ë¡œë“œ

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (833-1065ì¤„)

**ë°±ì—”ë“œ í”„ë¡ì‹œ API**:
- WELNO: `GET /api/v1/welno/mediarc-report/download`
- íŒŒíŠ¸ë„ˆ: `GET /api/v1/campaigns/disease-prediction/report/download`

**êµ¬í˜„**:
```typescript
const handleDownload = useCallback(async () => {
  if (!reportUrl) {
    alert('ë¦¬í¬íŠ¸ URLì´ ì—†ìŠµë‹ˆë‹¤.');
    return;
  }

  try {
    console.log('ğŸ“¥ [ë‹¤ìš´ë¡œë“œ] ë°±ì—”ë“œ í”„ë¡ì‹œ APIë¡œ ë‹¤ìš´ë¡œë“œ ì‹œë„...');

    let downloadUrl = '';
    if (oid) {
      // íŒŒíŠ¸ë„ˆ ì¼€ì´ìŠ¤
      downloadUrl = `/api/v1/campaigns/disease-prediction/report/download?oid=${oid}`;
    } else if (uuid && hospitalId) {
      // WELNO ì¼€ì´ìŠ¤
      downloadUrl = `/api/v1/welno/mediarc-report/download?uuid=${uuid}&hospital_id=${hospitalId}`;
    } else {
      alert('í™˜ì ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.');
      return;
    }

    // ë§í¬ í´ë¦­ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ
    const link = document.createElement('a');
    link.href = downloadUrl;
    link.download = `ì§ˆë³‘ì˜ˆì¸¡_ë¦¬í¬íŠ¸_${customerName || uuid}.pdf`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);

    console.log('âœ… [ë‹¤ìš´ë¡œë“œ] ë‹¤ìš´ë¡œë“œ ì™„ë£Œ');
  } catch (err) {
    console.error('âŒ [ë‹¤ìš´ë¡œë“œ] ì˜¤ë¥˜:', err);
    alert('ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
  }
}, [reportUrl, oid, uuid, hospitalId, customerName]);
```

**ë°±ì—”ë“œ í”„ë¡ì‹œ** (íŒŒì¼: `campaign_payment.py` 1007-1086ì¤„):
```python
@router.get("/disease-prediction/report/download")
async def download_campaign_report(oid: str = Query(...)):
    """íŒŒíŠ¸ë„ˆ ë¦¬í¬íŠ¸ PDF ë‹¤ìš´ë¡œë“œ (í”„ë¡ì‹œ)"""
    try:
        # OIDë¡œ ë¦¬í¬íŠ¸ URL ì¡°íšŒ
        with db_manager.get_connection() as conn:
            with conn.cursor() as cur:
                cur.execute("""
                    SELECT report_url, user_name
                    FROM welno.tb_campaign_payments
                    WHERE oid = %s
                """, (oid,))
                row = cur.fetchone()
                
        if not row or not row[0]:
            raise HTTPException(status_code=404, detail="ë¦¬í¬íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
        
        report_url = row[0]
        user_name = row[1] or "í™˜ì"
        
        # S3 URLì—ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
        async with httpx.AsyncClient() as client:
            response = await client.get(report_url)
            if response.status_code != 200:
                raise HTTPException(status_code=404, detail="ë¦¬í¬íŠ¸ íŒŒì¼ì„ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
            
            # í•œê¸€ íŒŒì¼ëª… ì²˜ë¦¬
            filename = f"ì§ˆë³‘ì˜ˆì¸¡_ë¦¬í¬íŠ¸_{user_name}.pdf"
            encoded_filename = quote(filename)
            
            return Response(
                content=response.content,
                media_type="application/pdf",
                headers={
                    "Content-Disposition": f"attachment; filename*=UTF-8''{encoded_filename}"
                }
            )
    except Exception as e:
        logger.error(f"download_campaign_report error: {e}")
        raise HTTPException(status_code=500, detail=str(e))
```

#### 5.4.2 ê³µìœ  ê¸°ëŠ¥ (ëª¨ë°”ì¼)

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (1115-1266ì¤„)

**êµ¬í˜„**:
```typescript
const handleShare = useCallback(async () => {
  if (!reportUrl) {
    alert('ë¦¬í¬íŠ¸ URLì´ ì—†ìŠµë‹ˆë‹¤.');
    return;
  }

  // ëª¨ë°”ì¼: Web Share API ë˜ëŠ” URL ë³µì‚¬
  if (isMobile) {
    if (navigator.share) {
      try {
        await navigator.share({
          title: 'ì§ˆë³‘ì˜ˆì¸¡ ë¦¬í¬íŠ¸',
          text: 'ì§ˆë³‘ì˜ˆì¸¡ ë¦¬í¬íŠ¸ë¥¼ ê³µìœ í•©ë‹ˆë‹¤.',
          url: window.location.href,
        });
        console.log('âœ… [ê³µìœ ] Web Share APIë¡œ ê³µìœ  ì™„ë£Œ');
      } catch (err) {
        console.log('âš ï¸ [ê³µìœ ] Web Share API ì·¨ì†Œ ë˜ëŠ” ì˜¤ë¥˜:', err);
        // í´ë°±: í´ë¦½ë³´ë“œ ë³µì‚¬
        await navigator.clipboard.writeText(window.location.href);
        alert('ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
      }
    } else {
      // Web Share API ë¯¸ì§€ì›: í´ë¦½ë³´ë“œ ë³µì‚¬
      await navigator.clipboard.writeText(window.location.href);
      alert('ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
    }
  } else {
    // ë°ìŠ¤í¬í†±: PDFë¥¼ ìƒˆ ì°½ì—ì„œ ì—´ê¸°
    window.open(reportUrl, '_blank');
  }
}, [reportUrl, isMobile]);
```

#### 5.4.3 ì´ë©”ì¼ ì „ì†¡

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (746-781ì¤„)

**ëª¨ë‹¬ í‘œì‹œ**:
```typescript
// ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
useEffect(() => {
  const handleEmailModal = () => {
    setShowEmailModal(true);
  };
  
  window.addEventListener('welno-email-modal-open', handleEmailModal);
  
  return () => {
    window.removeEventListener('welno-email-modal-open', handleEmailModal);
  };
}, []);
```

**ì´ë©”ì¼ ì œì¶œ**:
```typescript
const handleEmailSubmit = async (email: string) => {
  try {
    const response = await fetch(API_ENDPOINTS.UPDATE_EMAIL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        email,
        oid: oid || undefined,
        uuid: uuid || undefined,
        hospital_id: hospitalId || undefined
      }),
    });
    
    const data = await response.json();
    
    if (data.success) {
      alert('ì´ë©”ì¼ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. ë¦¬í¬íŠ¸ê°€ ë°œì†¡ë©ë‹ˆë‹¤.');
      setShowEmailModal(false);
    } else {
      alert(data.message || 'ì´ë©”ì¼ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    }
  } catch (err) {
    console.error('ì´ë©”ì¼ ë“±ë¡ ì˜¤ë¥˜:', err);
    alert('ì´ë©”ì¼ ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
  }
};
```

---

## 6. ìƒíƒœ ê´€ë¦¬

### 6.1 useState ìƒíƒœ ë³€ìˆ˜

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (92-115ì¤„)

| ìƒíƒœ ë³€ìˆ˜ | íƒ€ì… | ì´ˆê¸°ê°’ | ìš©ë„ |
|----------|------|--------|------|
| `loading` | boolean | `true` | ë¦¬í¬íŠ¸ ì¡°íšŒ ë¡œë”© ìƒíƒœ |
| `error` | string \| null | `null` | ì—ëŸ¬ ë©”ì‹œì§€ |
| `reportData` | AIMSResponse \| null | `null` | ë¦¬í¬íŠ¸ ë°ì´í„° (bodyage, rank, data) |
| `reportUrl` | string \| null | `null` | ë¦¬í¬íŠ¸ PDF URL |
| `customerName` | string \| null | `null` | ì‚¬ìš©ì ì´ë¦„ |
| `customerBirthday` | string \| null | `null` | ì‚¬ìš©ì ìƒë…„ì›”ì¼ |
| `customerPhone` | string \| null | `null` | ì‚¬ìš©ì ì „í™”ë²ˆí˜¸ |
| `currentAge` | number \| null | `null` | ê²€ì§„ë‚˜ì´ (ì‹¤ì œë‚˜ì´) |
| `ageComparison` | object \| null | `null` | ë‚˜ì´ ë¹„êµ ê²°ê³¼ (`ageDifference`, `isHealthier`) |
| `dataSource` | 'db' \| 'delayed' \| null | `null` | ë°ì´í„° ì¶œì²˜ |
| `reportUpdatedAt` | string \| null | `null` | ë¦¬í¬íŠ¸ ì—…ë°ì´íŠ¸ ì‹œê°„ |
| `showPanel` | boolean | `false` | íŒ¨ë„ í‘œì‹œ ì—¬ë¶€ (ì• ë‹ˆë©”ì´ì…˜) |
| `showAgeCardGlow` | boolean | `false` | ê±´ê°•ë‚˜ì´ ì¹´ë“œ ë°˜ì§ì„ íš¨ê³¼ |
| `isBrownMode` | boolean | `skinType === 'Br'` | ë¸Œë¼ìš´ ëª¨ë“œ ì—¬ë¶€ |
| `cancerLabelFilter` | 'ALL' \| 'NORMAL' \| 'BOUNDARY' \| 'ABNORMAL' | `'ALL'` | ì•” ì„¹ì…˜ í•„í„° |
| `diseaseLabelFilter` | 'ALL' \| 'NORMAL' \| 'BOUNDARY' \| 'ABNORMAL' | `'ALL'` | ì§ˆë³‘ ì„¹ì…˜ í•„í„° |
| `cancerSliderIndex` | number | `0` | ì•” ì„¹ì…˜ ìŠ¬ë¼ì´ë” ì¸ë±ìŠ¤ |
| `diseaseSliderIndex` | number | `0` | ì§ˆë³‘ ì„¹ì…˜ ìŠ¬ë¼ì´ë” ì¸ë±ìŠ¤ |
| `ageBoxClickCount` | number | `0` | ë‚˜ì´ ë°•ìŠ¤ í´ë¦­ íšŸìˆ˜ (ë””ë²„ê·¸ ëª¨ë“œ) |
| `showDebugModal` | boolean | `false` | ë””ë²„ê·¸ ëª¨ë‹¬ í‘œì‹œ ì—¬ë¶€ |
| `showEmailModal` | boolean | `false` | ì´ë©”ì¼ ëª¨ë‹¬ í‘œì‹œ ì—¬ë¶€ |

### 6.2 íƒ€ì… ì •ì˜

**íŒŒì¼ ìœ„ì¹˜**: `features/disease-report/types/aimsReport.ts`

```typescript
export interface AIMSInfluence {
  name: string;
  code: string;
  label: string;
}

export interface AIMSDataItem {
  name: string;
  code: string;
  type: 'disease' | 'cancer';
  label: 'NORMAL' | 'BOUNDARY' | 'ABNORMAL';
  rank: number;
  average: number;
  rate: number;
  influence: AIMSInfluence[] | null;
}

export interface AIMSResponse {
  bodyage: number;
  rank: number;
  data: AIMSDataItem[];
}
```

### 6.3 ì—ëŸ¬ ì²˜ë¦¬

**4ê°€ì§€ ì—ëŸ¬ ì¼€ì´ìŠ¤**:

1. **ë¦¬í¬íŠ¸ ì—†ìŒ**:
   ```typescript
   if (!data.has_report) {
     setError('ì§ˆë³‘ì˜ˆì¸¡ ë¦¬í¬íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤. ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
     setLoading(false);
     return;
   }
   ```

2. **ë¦¬í¬íŠ¸ ìƒì„± ì‹¤íŒ¨** (íŒŒíŠ¸ë„ˆ ì¼€ì´ìŠ¤):
   ```typescript
   if (data.should_redirect_to_landing) {
     alert(data.error_message || 'ë¦¬í¬íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
     const urlParams = new URLSearchParams(window.location.search);
     const redirectUrl = `/campaigns/disease-prediction/?${urlParams.toString()}`;
     window.location.href = redirectUrl;
     return;
   }
   ```

3. **ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜**:
   ```typescript
   catch (err) {
     console.error('[ë¦¬í¬íŠ¸ ì¡°íšŒ] ì˜¤ë¥˜:', err);
     setError('ë¦¬í¬íŠ¸ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
     setLoading(false);
   }
   ```

4. **í™˜ì ì •ë³´ ì—†ìŒ**:
   ```typescript
   if (!uuid || !hospitalId) {
     setError('í™˜ì ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.');
     setLoading(false);
     return;
   }
   ```

### 6.4 WebSocket ì—°ë™

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (230-330ì¤„)

**WebSocket ë©”ì‹œì§€ í•¸ë“¤ëŸ¬**:
```typescript
const { status: wsStatus, connect: wsConnect } = useWebSocketAuth({
  sessionId: sessionId || '',
  onMessage: (message) => {
    if (message.type === 'mediarc_report_completed') {
      console.log('âœ… [WebSocket] Mediarc ë¦¬í¬íŠ¸ ìƒì„± ì™„ë£Œ ì•Œë¦¼ ìˆ˜ì‹ :', message);
      
      // ë¦¬í¬íŠ¸ ì¬ì¡°íšŒ
      fetchReport();
      
      // ë°˜ì§ì„ íš¨ê³¼
      setShowAgeCardGlow(true);
    }
  }
});
```

**ì—°ê²° íŠ¸ë¦¬ê±°**:
```typescript
useEffect(() => {
  if (sessionId && shouldGenerate) {
    console.log('ğŸ”Œ [WebSocket] ì„¸ì…˜ ì—°ê²° ì‹œë„:', sessionId);
    wsConnect();
  }
}, [sessionId, shouldGenerate, wsConnect]);
```

---

## 7. ìŠ¤íƒ€ì¼ë§ ë° í…Œë§ˆ

### 7.1 CSS íŒŒì¼ ìœ„ì¹˜

| íŒŒì¼ | ê²½ë¡œ | ë¼ì¸ ìˆ˜ | ìš©ë„ |
|------|------|---------|------|
| `aims-report.scss` | `features/disease-report/styles/` | 1662ì¤„ | ë©”ì¸ ë¦¬í¬íŠ¸ ìŠ¤íƒ€ì¼ |
| `campaign.scss` | `features/disease-report/styles/` | - | ìº í˜ì¸ ìŠ¤íƒ€ì¼ |
| `campaign-fixed.scss` | `features/disease-report/styles/` | - | ê³ ì • ìš”ì†Œ ìŠ¤íƒ€ì¼ (í”Œë¡œíŒ… ë²„íŠ¼ ë“±) |
| `debug-delete-modal.scss` | `features/disease-report/styles/` | - | ë””ë²„ê·¸ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ |

### 7.2 í…Œë§ˆ ì„¤ì •

**Hook**: `useCampaignSkin`

**íŒŒì¼ ìœ„ì¹˜**: `hooks/useCampaignSkin.ts`

**ìŠ¤í‚¨ íƒ€ì…**:
- `'G'`: ê¸°ë³¸ ëª¨ë“œ (ë‹¤í¬ í…Œë§ˆ)
- `'Br'`: ë¸Œë¼ìš´ ëª¨ë“œ (ë¼ì´íŠ¸ í…Œë§ˆ)

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
const { skinType, skinConfig, changeSkin } = useCampaignSkin();

// ìŠ¤í‚¨ ë³€ê²½
const handleSkinChange = (newMode: 'default' | 'brown') => {
  const newSkinType = newMode === 'brown' ? 'Br' : 'G';
  changeSkin(newSkinType);
};
```

### 7.3 CSS ë³€ìˆ˜

**íŒŒì¼ ìœ„ì¹˜**: `aims-report.scss`

```scss
.aims-report-page {
  --report-page-bg: #f5f5f5;
  --report-panel-bg: #ffffff;
  --report-text-primary: #333333;
  --report-text-secondary: #666666;
  --report-accent-color: #4caf50;
  --report-chart-background: #e0e0e0;
  
  // ìƒíƒœ ìƒ‰ìƒ
  --success: #4caf50;  // ì •ìƒ (ë…¹ìƒ‰)
  --warning: #ff9800;  // ê²½ê³„ (ë…¸ë€ìƒ‰)
  --danger: #f44336;   // ìœ„í—˜ (ë¹¨ê°„ìƒ‰)
  
  &.skin-Br {
    --report-page-bg: #faf8f5;
    --report-panel-bg: #ffffff;
    --report-accent-color: #8b7355;
  }
}
```

### 7.4 ë°˜ì‘í˜• ë””ìì¸

**ë¸Œë ˆì´í¬í¬ì¸íŠ¸**:
```scss
// ëª¨ë°”ì¼
@media (max-width: 480px) {
  .probability-chart {
    width: 120px;
    height: 120px;
  }
  
  .probability-charts-grid {
    gap: 16px;
  }
}

// íƒœë¸”ë¦¿
@media (max-width: 768px) {
  .report-header {
    padding: 12px 16px;
  }
  
  .report-content {
    padding: 16px;
  }
}
```

### 7.5 ì• ë‹ˆë©”ì´ì…˜

#### 7.5.1 í˜ì´ë“œì¸ (íŒ¨ë„ í‘œì‹œ)

```scss
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.report-panel.show {
  animation: fadeInUp 0.8s ease-out;
}
```

#### 7.5.2 ë°˜ì§ì„ íš¨ê³¼ (ê±´ê°•ë‚˜ì´ ì¹´ë“œ)

```scss
@keyframes glow-pulse {
  0%, 100% {
    box-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
  }
  50% {
    box-shadow: 0 0 20px rgba(76, 175, 80, 0.8);
  }
}

.glow-effect {
  animation: glow-pulse 2s ease-in-out infinite;
}
```

#### 7.5.3 ìŠ¬ë¼ì´ë“œì—…

```scss
.report-content {
  transition: transform 0.3s ease-out;
  
  &.slide-up {
    transform: translateY(-20px);
  }
}
```

---

## 8. ë°ì´í„° íë¦„

### 8.1 ì „ì²´ íë¦„ ë‹¤ì´ì–´ê·¸ë¨ (Mermaid)

```mermaid
sequenceDiagram
    participant U as ì‚¬ìš©ì
    participant F as í”„ë¡ íŠ¸ì—”ë“œ<br/>(DiseaseReportPage)
    participant H as Hooks<br/>(useUnifiedStatus)
    participant B as ë°±ì—”ë“œ<br/>(API)
    participant WS as WebSocket
    participant DB as ë°ì´í„°ë² ì´ìŠ¤
    
    U->>F: í˜ì´ì§€ ì ‘ê·¼<br/>/disease-report?uuid=...&hospital_id=...
    F->>F: URL íŒŒë¼ë¯¸í„° íŒŒì‹±<br/>(uuid, hospital_id, oid, sessionId)
    
    F->>H: useUnifiedStatus í˜¸ì¶œ
    H->>B: í†µí•© ìƒíƒœ ì¡°íšŒ<br/>GET /api/v1/disease-report/check-partner-status
    B->>DB: ì•½ê´€/ê²°ì œ/ë°ì´í„°/ë¦¬í¬íŠ¸ í™•ì¸
    DB-->>B: ìƒíƒœ ì •ë³´ ë°˜í™˜
    B-->>H: í†µí•© ìƒíƒœ ë°˜í™˜
    H-->>F: status ë°˜í™˜
    
    alt ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸ í•„ìš”
        F->>F: useMatrixAutoRedirect<br/>(ì•½ê´€/ê²°ì œ/ë°ì´í„° ìˆ˜ì§‘ í˜ì´ì§€ë¡œ ì´ë™)
        F-->>U: ë¦¬ë‹¤ì´ë ‰íŠ¸
    else ë¦¬í¬íŠ¸ ì¡°íšŒ ê°€ëŠ¥
        F->>B: ë¦¬í¬íŠ¸ ì¡°íšŒ<br/>GET /api/v1/welno/mediarc-report?uuid=...
        B->>DB: ë¦¬í¬íŠ¸ ë°ì´í„° ì¡°íšŒ<br/>(welno_mediarc_reports)
        DB-->>B: mediarc_response ë°˜í™˜
        B->>B: URL ë§Œë£Œ í™•ì¸<br/>(HEAD ìš”ì²­)
        B-->>F: ë¦¬í¬íŠ¸ ë°ì´í„° ë°˜í™˜<br/>(bodyage, rank, disease_data, cancer_data)
        
        F->>F: ë°ì´í„° ë³€í™˜<br/>(disease + cancer í†µí•©)
        F->>F: ì •ë ¬ ë¡œì§<br/>(ABNORMAL > BOUNDARY > NORMAL)
        F->>F: ë‚˜ì´ ê³„ì‚°<br/>(ìƒë…„ì›”ì¼ ê¸°ë°˜)
        F->>F: setReportData(aimsData)
        F->>F: ì• ë‹ˆë©”ì´ì…˜ íŠ¸ë¦¬ê±°<br/>(íŒ¨ë„ í‘œì‹œ, ë°˜ì§ì„ íš¨ê³¼)
        F-->>U: ë¦¬í¬íŠ¸ í™”ë©´ ë Œë”ë§
    end
    
    opt ë¦¬í¬íŠ¸ ìƒì„± ëŒ€ê¸° (sessionId ì¡´ì¬)
        F->>WS: WebSocket ì—°ê²°<br/>ws://.../tilko/ws/{sessionId}
        WS-->>F: ì—°ê²° ì™„ë£Œ
        
        loop ë¦¬í¬íŠ¸ ìƒì„± ì¤‘
            WS-->>F: ì§„í–‰ ìƒí™© ë©”ì‹œì§€
        end
        
        WS-->>F: mediarc_report_completed
        F->>B: ë¦¬í¬íŠ¸ ì¬ì¡°íšŒ
        B-->>F: ë¦¬í¬íŠ¸ ë°ì´í„° ë°˜í™˜
        F->>F: ë°˜ì§ì„ íš¨ê³¼ íŠ¸ë¦¬ê±°
        F-->>U: ë¦¬í¬íŠ¸ í™”ë©´ ê°±ì‹ 
    end
    
    U->>F: ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ í´ë¦­
    F->>B: PDF ë‹¤ìš´ë¡œë“œ ìš”ì²­<br/>GET /api/v1/welno/mediarc-report/download
    B->>DB: report_url ì¡°íšŒ
    DB-->>B: S3 URL ë°˜í™˜
    B->>B: S3 íŒŒì¼ ë‹¤ìš´ë¡œë“œ
    B-->>F: PDF íŒŒì¼ ë°˜í™˜
    F-->>U: íŒŒì¼ ë‹¤ìš´ë¡œë“œ
```

### 8.2 ë‹¨ê³„ë³„ ì„¤ëª…

#### ë‹¨ê³„ 1: í˜ì´ì§€ ì§„ì… ë° URL íŒŒì‹±

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (68-74ì¤„)

```typescript
const uuid = searchParams.get('uuid') || StorageManager.getItem(STORAGE_KEYS.PATIENT_UUID) || '';
const hospitalId = searchParams.get('hospital_id') || searchParams.get('hospital') || StorageManager.getItem(STORAGE_KEYS.HOSPITAL_ID) || '';
const sessionId = searchParams.get('sessionId') || null;
const shouldGenerate = searchParams.get('generate') === 'true';
const oid = searchParams.get('oid') || null;
const partnerId = searchParams.get('partner') || null;
```

#### ë‹¨ê³„ 2: í†µí•© ìƒíƒœ í™•ì¸

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (79-84ì¤„)

```typescript
const { status: unifiedStatus, loading: statusLoading, error: statusError } = useUnifiedStatus(
  uuid, 
  hospitalId, 
  partnerId
);
```

**useUnifiedStatus Hook**:
- ë°±ì—”ë“œ API í˜¸ì¶œ: `POST /api/v1/disease-report/check-partner-status`
- ë°˜í™˜ ê°’: `{ status, loading, error }`
- ìƒíƒœ íƒ€ì…: `TERMS_REQUIRED`, `PAYMENT_REQUIRED`, `REPORT_READY`, `REPORT_PENDING` ë“±

#### ë‹¨ê³„ 3: ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸ (í•„ìš” ì‹œ)

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (86-90ì¤„)

```typescript
useMatrixAutoRedirect(unifiedStatus, uuid, partnerId);
useFloatingButton(unifiedStatus, uuid, partnerId);
```

**ë¦¬ë‹¤ì´ë ‰íŠ¸ ì¡°ê±´**:
- `TERMS_REQUIRED` â†’ ì•½ê´€ ë™ì˜ í˜ì´ì§€
- `PAYMENT_REQUIRED` â†’ ê²°ì œ í˜ì´ì§€
- `DATA_REQUIRED` â†’ ë°ì´í„° ìˆ˜ì§‘ í˜ì´ì§€ (Tilko)

#### ë‹¨ê³„ 4: ë¦¬í¬íŠ¸ API ì¡°íšŒ

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (456-567ì¤„)

**2ê°€ì§€ ì¼€ì´ìŠ¤**:

1. **íŒŒíŠ¸ë„ˆ ì¼€ì´ìŠ¤** (oid ì¡´ì¬):
   ```typescript
   const response = await fetch(`/api/v1/campaigns/disease-prediction/report?oid=${oid}`);
   ```

2. **WELNO ì¼€ì´ìŠ¤** (uuid + hospital_id):
   ```typescript
   const response = await fetch(`/api/v1/welno/mediarc-report?uuid=${uuid}&hospital_id=${hospitalId}`);
   ```

#### ë‹¨ê³„ 5: ë°ì´í„° ë³€í™˜ ë° ì •ë ¬

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (474-493ì¤„, 559-577ì¤„)

```typescript
// disease_data + cancer_data í†µí•©
const diseaseData = medarcResponse.disease_data || [];
const cancerData = medarcResponse.cancer_data || [];
const combinedData = [...diseaseData, ...cancerData];

const aimsData: AIMSResponse = {
  bodyage: medarcResponse.bodyage || 0,
  rank: medarcResponse.rank || 0,
  data: combinedData
};

setReportData(aimsData);
```

#### ë‹¨ê³„ 6: ë Œë”ë§ ë° ì• ë‹ˆë©”ì´ì…˜

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (440-452ì¤„)

```typescript
// íŒ¨ë„ì„ ë¿Œì—° ìƒíƒœë¡œ ì˜¬ë¼ì˜¤ê²Œ í•¨
setTimeout(() => {
  setShowPanel(true);
  // íŒ¨ë„ì´ ì˜¬ë¼ì˜¨ í›„ ìŠ¤í”¼ë„ˆë¥¼ ë” ë³´ì—¬ì£¼ê³ , ê·¸ ë‹¤ìŒ ë¿Œì—° ìƒíƒœ ì œê±° ë° ë°˜ì§ì„ íš¨ê³¼
  setTimeout(() => {
    setShowAgeCardGlow(true); // ë°˜ì§ì„ íš¨ê³¼ íŠ¸ë¦¬ê±°
  }, 1200);
}, 800);
```

#### ë‹¨ê³„ 7: WebSocket ì—°ë™ (ì‹¤ì‹œê°„ ìƒì„± ëª¨ë‹ˆí„°ë§)

**íŒŒì¼ ìœ„ì¹˜**: `DiseaseReportPage.tsx` (230-330ì¤„)

```typescript
const { status: wsStatus, connect: wsConnect } = useWebSocketAuth({
  sessionId: sessionId || '',
  onMessage: (message) => {
    if (message.type === 'mediarc_report_completed') {
      console.log('âœ… [WebSocket] Mediarc ë¦¬í¬íŠ¸ ìƒì„± ì™„ë£Œ ì•Œë¦¼ ìˆ˜ì‹ ');
      fetchReport(); // ë¦¬í¬íŠ¸ ì¬ì¡°íšŒ
      setShowAgeCardGlow(true); // ë°˜ì§ì„ íš¨ê³¼
    }
  }
});
```

---

## 9. íŒŒì¼ êµ¬ì¡° ë° ê²½ë¡œ

### 9.1 ì£¼ìš” íŒŒì¼ ê²½ë¡œ í‘œ

| ë¶„ë¥˜ | íŒŒì¼ëª… | ê²½ë¡œ | ë¼ì¸ ìˆ˜ | ì„¤ëª… |
|------|--------|------|---------|------|
| **ë©”ì¸ ì»´í¬ë„ŒíŠ¸** | `DiseaseReportPage.tsx` | `features/disease-report/pages/` | 2157 | ë¦¬í¬íŠ¸ í™”ë©´ ë©”ì¸ ì»´í¬ë„ŒíŠ¸ |
| **íƒ€ì… ì •ì˜** | `aimsReport.ts` | `features/disease-report/types/` | 45 | ë¦¬í¬íŠ¸ ë°ì´í„° íƒ€ì… ì •ì˜ |
| **ê±´ê°•ë‚˜ì´ ì»´í¬ë„ŒíŠ¸** | `HealthAgeSection/index.tsx` | `components/health/HealthAgeSection/` | 101 | ê±´ê°•ë‚˜ì´ ë¹„êµ ì„¹ì…˜ |
| **Hooks** | `useUnifiedStatus.ts` | `features/disease-report/hooks/` | - | í†µí•© ìƒíƒœ ê´€ë¦¬ |
| | `useMatrixAutoRedirect.ts` | `features/disease-report/pages/DiseaseReportPage/hooks/` | - | ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë¡œì§ |
| | `useFloatingButton.ts` | `features/disease-report/pages/DiseaseReportPage/hooks/` | - | í”Œë¡œíŒ… ë²„íŠ¼ ì œì–´ |
| | `useCampaignSkin.ts` | `features/disease-report/hooks/` | - | ìŠ¤í‚¨ ëª¨ë“œ ê´€ë¦¬ |
| | `useWebSocketAuth.ts` | `hooks/` | - | WebSocket ì—°ê²° |
| **ìŠ¤íƒ€ì¼** | `aims-report.scss` | `features/disease-report/styles/` | 1662 | ë©”ì¸ ë¦¬í¬íŠ¸ ìŠ¤íƒ€ì¼ |
| | `campaign.scss` | `features/disease-report/styles/` | - | ìº í˜ì¸ ìŠ¤íƒ€ì¼ |
| | `campaign-fixed.scss` | `features/disease-report/styles/` | - | ê³ ì • ìš”ì†Œ ìŠ¤íƒ€ì¼ |
| **ìœ í‹¸ë¦¬í‹°** | `ageCalculator.ts` | `features/disease-report/utils/` | - | ë‚˜ì´ ê³„ì‚° í•¨ìˆ˜ |
| | `gtm.ts` | `features/disease-report/utils/` | - | GTM ì¶”ì  í•¨ìˆ˜ |
| | `legacyCompat.ts` | `features/disease-report/utils/` | - | ë ˆê±°ì‹œ í˜¸í™˜ì„± í•¨ìˆ˜ |
| **ë°±ì—”ë“œ API** | `campaign_payment.py` | `backend/app/api/v1/endpoints/` | 1322 | íŒŒíŠ¸ë„ˆ ë¦¬í¬íŠ¸ API |
| | `welno_data.py` | `backend/app/api/v1/endpoints/` | 2118 | WELNO ë¦¬í¬íŠ¸ API |
| | `report_service.py` | `backend/app/services/mediarc/` | 288 | Mediarc ë¦¬í¬íŠ¸ ì„œë¹„ìŠ¤ |

### 9.2 ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
planning-platform/
â”œâ”€â”€ frontend/src/
â”‚   â”œâ”€â”€ features/disease-report/
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â””â”€â”€ DiseaseReportPage.tsx
â”‚   â”‚   â”‚       â””â”€â”€ hooks/
â”‚   â”‚   â”‚           â”œâ”€â”€ useMatrixAutoRedirect.ts
â”‚   â”‚   â”‚           â””â”€â”€ useFloatingButton.ts
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”œâ”€â”€ useUnifiedStatus.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ useCampaignSkin.ts
â”‚   â”‚   â”‚   â””â”€â”€ useAIMSReportPolling.ts
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ DebugDeleteModal.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ReportActionModal.tsx
â”‚   â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”‚   â”œâ”€â”€ aimsReport.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â”‚   â”œâ”€â”€ aims-report.scss
â”‚   â”‚   â”‚   â”œâ”€â”€ campaign.scss
â”‚   â”‚   â”‚   â””â”€â”€ campaign-fixed.scss
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â”œâ”€â”€ ageCalculator.ts
â”‚   â”‚       â”œâ”€â”€ gtm.ts
â”‚   â”‚       â””â”€â”€ legacyCompat.ts
â”‚   â”œâ”€â”€ components/health/
â”‚   â”‚   â””â”€â”€ HealthAgeSection/
â”‚   â”‚       â”œâ”€â”€ index.tsx
â”‚   â”‚       â”œâ”€â”€ styles.scss
â”‚   â”‚       â””â”€â”€ types.ts
â”‚   â””â”€â”€ hooks/
â”‚       â””â”€â”€ useWebSocketAuth.ts
â”‚
â””â”€â”€ backend/app/
    â”œâ”€â”€ api/v1/endpoints/
    â”‚   â”œâ”€â”€ campaign_payment.py
    â”‚   â””â”€â”€ welno_data.py
    â””â”€â”€ services/mediarc/
        â””â”€â”€ report_service.py
```

---

## 10. ì½”ë“œ ì˜ˆì‹œ ë° êµ¬í˜„

### 10.1 API í˜¸ì¶œ ì½”ë“œ

#### 10.1.1 ë¦¬í¬íŠ¸ ì¡°íšŒ (WELNO ì¼€ì´ìŠ¤)

```typescript
const fetchReport = useCallback(async () => {
  if (!uuid || !hospitalId) {
    setError('í™˜ì ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.');
    setLoading(false);
    return;
  }

  try {
    console.log(`[ë¦¬í¬íŠ¸ ì¡°íšŒ] WELNO ì¼€ì´ìŠ¤ - uuid: ${uuid}, hospital: ${hospitalId}`);
    
    const response = await fetch(`/api/v1/welno/mediarc-report?uuid=${uuid}&hospital_id=${hospitalId}`);
    const data = await response.json();
    
    if (data.success && data.has_report && data.data) {
      // ë¦¬í¬íŠ¸ URL ì €ì¥
      if (data.data.report_url) {
        setReportUrl(data.data.report_url);
      }
      
      // ë°ì´í„° ë³€í™˜
      const diseaseData = data.data.disease_data || [];
      const cancerData = data.data.cancer_data || [];
      const combinedData = [...diseaseData, ...cancerData];
      
      const aimsData: AIMSResponse = {
        bodyage: data.data.bodyage || 0,
        rank: data.data.rank || 0,
        data: combinedData
      };
      
      setReportDataWithInfo(
        aimsData,
        'db',
        {
          name: data.data.customer_info?.name,
          birthday: data.data.customer_info?.birthday
        }
      );
      setLoading(false);
    } else {
      setError('ë¦¬í¬íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      setLoading(false);
    }
  } catch (err) {
    console.error('[ë¦¬í¬íŠ¸ ì¡°íšŒ] ì˜¤ë¥˜:', err);
    setError('ë¦¬í¬íŠ¸ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    setLoading(false);
  }
}, [uuid, hospitalId]);
```

#### 10.1.2 ë¦¬í¬íŠ¸ ì¡°íšŒ (íŒŒíŠ¸ë„ˆ ì¼€ì´ìŠ¤)

```typescript
if (oid) {
  try {
    console.log(`[ë¦¬í¬íŠ¸ ì¡°íšŒ] íŒŒíŠ¸ë„ˆ ì¼€ì´ìŠ¤ - oid: ${oid}`);
    
    const response = await fetch(`/api/v1/campaigns/disease-prediction/report?oid=${oid}`);
    const data = await response.json();
    
    if (data.success && data.report_url) {
      setReportUrl(data.report_url);
      
      const medarcResponse = data.mediarc_response || {};
      const diseaseData = medarcResponse.disease_data || [];
      const cancerData = medarcResponse.cancer_data || [];
      const combinedData = [...diseaseData, ...cancerData];
      
      const aimsData: AIMSResponse = {
        bodyage: medarcResponse.bodyage || 0,
        rank: medarcResponse.rank || 0,
        data: combinedData
      };
      
      setReportDataWithInfo(
        aimsData,
        'db',
        {
          name: data.user_name,
          birthday: ''
        }
      );
      setLoading(false);
    } else if (data.should_redirect_to_landing) {
      // ë¦¬í¬íŠ¸ ìƒì„± ì‹¤íŒ¨ - ëœë”© í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
      alert(data.error_message || 'ë¦¬í¬íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      const urlParams = new URLSearchParams(window.location.search);
      const redirectUrl = `/campaigns/disease-prediction/?${urlParams.toString()}`;
      window.location.href = redirectUrl;
    } else {
      setError('ë¦¬í¬íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      setLoading(false);
    }
  } catch (err) {
    console.error('[ë¦¬í¬íŠ¸ ì¡°íšŒ] íŒŒíŠ¸ë„ˆ ì˜¤ë¥˜:', err);
    setError('ë¦¬í¬íŠ¸ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    setLoading(false);
  }
}
```

### 10.2 ë°ì´í„° ë³€í™˜ ì½”ë“œ

#### 10.2.1 í•„í„°ë§ ë¡œì§

```typescript
// ë ˆì´ë¸” ì •ê·œí™” í•¨ìˆ˜ (í•œê¸€/ì˜ì–´ í†µí•©)
const normalizeLabel = (label: string): 'NORMAL' | 'BOUNDARY' | 'ABNORMAL' | string => {
  const labelMap: Record<string, string> = {
    'ì •ìƒ': 'NORMAL',
    'NORMAL': 'NORMAL',
    'ê²½ê³„': 'BOUNDARY',
    'BOUNDARY': 'BOUNDARY',
    'ì´ìƒ': 'BOUNDARY',
    'ìœ„í—˜': 'ABNORMAL',
    'ABNORMAL': 'ABNORMAL'
  };
  return labelMap[label] || label;
};

// ì•” ë°ì´í„° í•„í„°ë§
const filteredCancerData = reportData?.data
  ? [...reportData.data]
      .filter((item) => {
        if (item.type !== 'cancer') return false;
        if (cancerLabelFilter !== 'ALL' && normalizeLabel(item.label) !== cancerLabelFilter) return false;
        return true;
      })
  : [];
```

#### 10.2.2 ì •ë ¬ ë¡œì§

```typescript
const sortedData = reportData?.data
  ? [...reportData.data].sort((a, b) => {
      // ABNORMAL > BOUNDARY > NORMAL ìˆœì„œ
      const labelOrder: Record<string, number> = { 'ABNORMAL': 3, 'BOUNDARY': 2, 'NORMAL': 1 };
      const orderDiff = (labelOrder[normalizeLabel(b.label)] || 0) - (labelOrder[normalizeLabel(a.label)] || 0);
      if (orderDiff !== 0) return orderDiff;
      
      // ê°™ì€ ë ˆì´ë¸”ì´ë©´ rank ë†’ì€ ìˆœ
      return b.rank - a.rank;
    })
  : [];
```

### 10.3 ì°¨íŠ¸ ë Œë”ë§ ì½”ë“œ

```tsx
<div className="probability-charts-grid">
  {sortedData.slice(0, 4).map((item) => {
    const percentage = Math.min(item.rate, 100);
    const circumference = 2 * Math.PI * 45;
    const strokeDashoffset = circumference * (1 - percentage / 100);
    
    return (
      <div key={item.code} className="probability-chart">
        <div className="chart-circle">
          <svg className="chart-svg" viewBox="0 0 100 100">
            <circle
              className="chart-background"
              cx="50"
              cy="50"
              r="45"
            />
            <circle
              className="chart-progress"
              cx="50"
              cy="50"
              r="45"
              strokeDasharray={circumference}
              strokeDashoffset={strokeDashoffset}
              style={{ stroke: getLabelColor(item.label) }}
            />
          </svg>
          <div className="chart-text">
            <span className="chart-percentage">{percentage}%</span>
            <span className="chart-label">{getLabelText(item.label)}</span>
          </div>
        </div>
        <p className="chart-disease-name">{item.name}</p>
      </div>
    );
  })}
</div>
```

### 10.4 ìŠ¬ë¼ì´ë” êµ¬í˜„ ì½”ë“œ

```typescript
// Transform ê³„ì‚°
const getSliderTransform = (index: number, containerRef: React.RefObject<HTMLDivElement>) => {
  if (!containerRef.current) return 'translateX(0)';
  const containerWidth = containerRef.current.offsetWidth;
  const cardWidth = containerWidth;
  const gap = 16;
  const offset = -(index * (cardWidth + gap));
  return `translateX(${offset}px)`;
};

// í„°ì¹˜ í•¸ë“¤ëŸ¬
const handleCancerTouchStart = (e: React.TouchEvent) => {
  setCancerTouchStartX(e.targetTouches[0].clientX);
};

const handleCancerTouchMove = (e: React.TouchEvent) => {
  setCancerTouchEndX(e.targetTouches[0].clientX);
};

const handleCancerTouchEnd = () => {
  if (cancerTouchStartX === null || cancerTouchEndX === null) return;

  const diff = cancerTouchStartX - cancerTouchEndX;
  const threshold = 50;

  if (Math.abs(diff) > threshold) {
    if (diff > 0) {
      // ì™¼ìª½ ìŠ¤ì™€ì´í”„ (ë‹¤ìŒ)
      setCancerSliderIndex((prev) => Math.min(prev + 1, filteredCancerData.length - 1));
    } else {
      // ì˜¤ë¥¸ìª½ ìŠ¤ì™€ì´í”„ (ì´ì „)
      setCancerSliderIndex((prev) => Math.max(prev - 1, 0));
    }
  }

  setCancerTouchStartX(null);
  setCancerTouchEndX(null);
};
```

### 10.5 ë‚˜ì´ ê³„ì‚° ì½”ë“œ

```typescript
const calculateCurrentAge = (birthday: string): number => {
  const today = new Date();
  const birthDate = new Date(birthday);
  
  let age = today.getFullYear() - birthDate.getFullYear();
  const monthDiff = today.getMonth() - birthDate.getMonth();
  
  if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
    age--;
  }
  
  return age;
};

// ë‚˜ì´ ì¶”ì • (ìƒë…„ì›”ì¼ ì—†ì„ ë•Œ)
if (age === null && data) {
  age = Math.round(data.bodyage + 2);
  console.log(`ìƒë…„ì›”ì¼ ì—†ìŒ: ê±´ê°•ë‚˜ì´(${data.bodyage}ì„¸) ê¸°ì¤€ìœ¼ë¡œ ${age}ì„¸ ì¶”ì •`);
}
```

---

## ğŸ“Œ í•µì‹¬ í¬ì¸íŠ¸ ìš”ì•½

### 1. ë°ì´í„° íë¦„
- **WELNO ì¼€ì´ìŠ¤**: `uuid` + `hospital_id` â†’ `welno_mediarc_reports` í…Œì´ë¸” ì¡°íšŒ
- **íŒŒíŠ¸ë„ˆ ì¼€ì´ìŠ¤**: `oid` â†’ `tb_campaign_payments` í…Œì´ë¸” ì¡°íšŒ
- **ë°ì´í„° í†µí•©**: `disease_data` + `cancer_data` â†’ ë‹¨ì¼ ë°°ì—´ë¡œ í†µí•©
- **ì •ë ¬**: `ABNORMAL` > `BOUNDARY` > `NORMAL`, `rank` ë†’ì€ ìˆœ

### 2. ì£¼ìš” ê¸°ëŠ¥
- **ê±´ê°•ë‚˜ì´ ë¹„êµ**: ê²€ì§„ë‚˜ì´ vs ê±´ê°•ë‚˜ì´ ì‹œê°í™”
- **ë“±ìˆ˜ í‘œì‹œ**: ì¢‹ì€ í•­ëª© 2ê°œ (ğŸ¥‡ğŸ¥ˆ), ë‚˜ìœ í•­ëª© 2ê°œ (âš ï¸)
- **ë°œë³‘í™•ë¥  ì°¨íŠ¸**: ì›í˜• í”„ë¡œê·¸ë ˆìŠ¤ ì°¨íŠ¸ (2x2 ê·¸ë¦¬ë“œ)
- **ì§ˆë³‘/ì•” ì¹´ë“œ**: ìŠ¬ë¼ì´ë” í˜•íƒœ (ìŠ¤ì™€ì´í”„ ì§€ì›)
- **PDF ë‹¤ìš´ë¡œë“œ**: ë°±ì—”ë“œ í”„ë¡ì‹œ API ì‚¬ìš© (í•œê¸€ íŒŒì¼ëª… ì§€ì›)

### 3. ì„±ëŠ¥ ìµœì í™”
- **WebSocket ì—°ë™**: ì‹¤ì‹œê°„ ë¦¬í¬íŠ¸ ìƒì„± ëª¨ë‹ˆí„°ë§
- **ì• ë‹ˆë©”ì´ì…˜**: íŒ¨ë„ í‘œì‹œ, ë°˜ì§ì„ íš¨ê³¼ (CSS ì• ë‹ˆë©”ì´ì…˜)
- **ë°˜ì‘í˜• ë””ìì¸**: ëª¨ë°”ì¼/íƒœë¸”ë¦¿/ë°ìŠ¤í¬í†± ëŒ€ì‘
- **URL ë§Œë£Œ ì²˜ë¦¬**: ìë™ ì¬í™•ì¸ ë° ëŒ€ì²´ URL ì‚¬ìš©

### 4. ì—ëŸ¬ ì²˜ë¦¬
- ë¦¬í¬íŠ¸ ì—†ìŒ â†’ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
- ë¦¬í¬íŠ¸ ìƒì„± ì‹¤íŒ¨ â†’ ëœë”© í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸
- ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ â†’ ì¬ì‹œë„ ì•ˆë‚´
- í™˜ì ì •ë³´ ì—†ìŒ â†’ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ

---

## ğŸ“ ë¬¸ì˜ ë° ì¶”ê°€ ì •ë³´

ì´ ë¬¸ì„œëŠ” ì§ˆë³‘ì˜ˆì¸¡ ë¦¬í¬íŠ¸ í™”ë©´ì˜ í˜„ì¬ êµ¬ì¡°ë¥¼ ë©´ë°€í•˜ê²Œ ë¶„ì„í•œ ê²°ê³¼ì…ë‹ˆë‹¤.

**ì¶”ê°€ ë¬¸ì„œ**:
- ì§ˆë³‘ì˜ˆì¸¡ ìº í˜ì¸ ì „ì²´ í”Œë¡œìš°: `/docs/ì§ˆë³‘ì˜ˆì¸¡_ìº í˜ì¸_ì „ì²´_í”Œë¡œìš°_ë°_ì‹œìŠ¤í…œ_ê°œìš”.md` (ì˜ˆì •)
- API ë° ë°ì´í„° ë§¤í•‘ ìƒì„¸: `/docs/ì§ˆë³‘ì˜ˆì¸¡_ìº í˜ì¸_API_ë°_ë°ì´í„°_ë§¤í•‘_ìƒì„¸.md` (ì˜ˆì •)

**ê´€ë ¨ íŒŒì¼**:
- í”„ë¡ íŠ¸ì—”ë“œ: `planning-platform/frontend/src/features/disease-report/`
- ë°±ì—”ë“œ: `planning-platform/backend/app/api/v1/endpoints/campaign_payment.py`
- ë°±ì—”ë“œ: `planning-platform/backend/app/services/mediarc/report_service.py`

---

**ë¬¸ì„œ ë²„ì „**: 1.0  
**ìƒì„±ì¼**: 2026-01-31  
**ìµœì¢… ìˆ˜ì •**: 2026-01-31
