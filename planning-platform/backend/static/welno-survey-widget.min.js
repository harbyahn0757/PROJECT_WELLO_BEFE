!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.WelnoSurveyWidget=t():e.WelnoSurveyWidget=t()}(this,()=>{return e={565(e,t){var i,n=[{key:"reservation_process",label:"예약 과정"},{key:"facility_cleanliness",label:"시설 청결도"},{key:"staff_kindness",label:"직원 친절도"},{key:"waiting_time",label:"대기 시간"},{key:"overall_satisfaction",label:"전반적 만족도"}];class s{constructor(e){if(!e.apiKey)throw new Error("WelnoSurveyWidget: apiKey is required");if(!e.hospitalId)throw new Error("WelnoSurveyWidget: hospitalId is required");var t=e.baseUrl||("undefined"!=typeof window?window.location.origin:"");this.config={apiKey:e.apiKey,hospitalId:e.hospitalId,baseUrl:t,uuid:e.uuid||"survey_"+Date.now(),position:e.position||"bottom-right",primaryColor:e.primaryColor||"#7B5E4F",buttonLabel:e.buttonLabel||"만족도 조사",title:e.title||"병원 만족도 설문",subtitle:e.subtitle||"소중한 의견을 남겨주세요",onSubmit:e.onSubmit||null,onError:e.onError||null,autoOpen:e.autoOpen||!1,hideButton:e.hideButton||!1},this.state={isOpen:!1,isSubmitting:!1,isSubmitted:!1,isInitialized:!1,ratings:{}},this.elements={},this.cssPrefix="welno-survey-widget"}init(){this.state.isInitialized||(this.injectStyles(),this.createDOM(),this.bindEvents(),this.state.isInitialized=!0,this.config.autoOpen&&setTimeout(function(){this.open()}.bind(this),500))}injectStyles(){var e=this.cssPrefix+"-styles";if(!document.getElementById(e)){if(!document.getElementById("welno-noto-sans-kr"))try{var t=document.createElement("link");t.id="welno-noto-sans-kr",t.rel="stylesheet",t.href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&display=swap",t.onerror=function(){},document.head.appendChild(t)}catch(e){}var i=this.config.primaryColor,n=this.cssPrefix,s="."+n+'-container {  position: fixed;  z-index: 9999;  font-family: "Noto Sans KR", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;  font-size: 15px;  line-height: 1.4;  color: #333;  box-sizing: border-box;}.'+n+"-container *, ."+n+"-container *::before, ."+n+"-container *::after { box-sizing: border-box; }."+n+"-container.position-bottom-right { bottom: 24px; right: 24px; }."+n+"-container.position-bottom-left { bottom: 24px; left: 24px; }."+n+"-button {  display: flex; align-items: center; gap: 8px;  padding: 12px 20px;  border: none; border-radius: 28px;  background: "+i+";  color: #fff;  font-size: 14px; font-weight: 600;  box-shadow: 0 4px 12px rgba(0,0,0,0.15);  cursor: pointer;  transition: all 0.3s ease;  outline: none;}."+n+"-button:hover { transform: scale(1.05); box-shadow: 0 6px 16px rgba(0,0,0,0.2); }."+n+"-button svg { width: 18px; height: 18px; flex-shrink: 0; }."+n+"-overlay {  position: fixed; inset: 0;  background: rgba(0,0,0,0.5);  display: none;  align-items: center; justify-content: center;  z-index: 10000;  animation: "+n+"-fadeIn 0.25s ease-out;}."+n+"-overlay.open { display: flex; }@keyframes "+n+"-fadeIn { from { opacity: 0; } to { opacity: 1; } }."+n+"-panel {  background: #fff;  border-radius: 20px;  width: 420px; max-width: 92vw;  max-height: 90vh;  overflow-y: auto;  box-shadow: 0 20px 60px rgba(0,0,0,0.2);  animation: "+n+"-slideUp 0.3s ease-out;}@keyframes "+n+"-slideUp { from { transform: translateY(30px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }."+n+"-header {  background: "+i+";  color: #fff;  padding: 20px 24px;  border-radius: 20px 20px 0 0;  display: flex; justify-content: space-between; align-items: flex-start;}."+n+"-header h3 { margin: 0 0 4px; font-size: 18px; font-weight: 700; }."+n+"-header p { margin: 0; font-size: 13px; opacity: 0.85; }."+n+"-close {  background: none; border: none;  color: #fff; font-size: 22px;  cursor: pointer; padding: 4px;  border-radius: 4px; line-height: 1;}."+n+"-close:hover { background: rgba(255,255,255,0.15); }."+n+"-body { padding: 24px; }."+n+"-field { margin-bottom: 20px; }."+n+"-field-label {  font-size: 14px; font-weight: 600; color: #333;  margin-bottom: 8px; display: block;}."+n+"-stars {  display: flex; gap: 6px;}."+n+"-star {  width: 36px; height: 36px;  border: 2px solid #ddd;  border-radius: 50%;  background: #fff;  cursor: pointer;  display: flex; align-items: center; justify-content: center;  font-size: 18px;  transition: all 0.15s;  color: #ccc;}."+n+"-star:hover { border-color: "+i+"; transform: scale(1.1); }."+n+"-star.selected {  background: "+i+";  border-color: "+i+";  color: #fff;}."+n+"-comment {  width: 100%;  min-height: 80px;  padding: 12px;  border: 1px solid #ddd;  border-radius: 12px;  font-size: 14px;  font-family: inherit;  resize: vertical;  outline: none;  transition: border-color 0.2s;}."+n+"-comment:focus { border-color: "+i+"; }."+n+"-submit {  width: 100%;  padding: 14px;  background: "+i+";  color: #fff;  border: none;  border-radius: 12px;  font-size: 16px;  font-weight: 700;  cursor: pointer;  transition: all 0.2s;  margin-top: 8px;}."+n+"-submit:hover:not(:disabled) { filter: brightness(0.9); }."+n+"-submit:disabled { opacity: 0.5; cursor: not-allowed; }."+n+"-thanks {  text-align: center;  padding: 60px 24px;}."+n+"-thanks-icon {  font-size: 48px;  margin-bottom: 16px;}."+n+"-thanks h3 {  margin: 0 0 8px;  font-size: 20px;  font-weight: 700;  color: #333;}."+n+"-thanks p {  margin: 0;  font-size: 14px;  color: #666;}@media (max-width: 480px) {  ."+n+"-panel { width: 100%; max-width: 100%; border-radius: 20px 20px 0 0; position: fixed; bottom: 0; left: 0; right: 0; max-height: 85vh; }  ."+n+"-header { border-radius: 20px 20px 0 0; }  ."+n+"-container { bottom: 16px; right: 16px; }}",o=document.createElement("style");o.id=e,o.textContent=s,document.head.appendChild(o)}}createDOM(){var e=this.cssPrefix;this.elements.container=document.createElement("div"),this.elements.container.className=e+"-container position-"+this.config.position,this.elements.button=document.createElement("button"),this.elements.button.className=e+"-button",this.elements.button.innerHTML='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3H14z"/><path d="M7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"/></svg><span>'+this.config.buttonLabel+"</span>",this.elements.overlay=document.createElement("div"),this.elements.overlay.className=e+"-overlay";var t=document.createElement("div");t.className=e+"-panel";var i=document.createElement("div");i.className=e+"-header",i.innerHTML="<div><h3>"+this.config.title+"</h3><p>"+this.config.subtitle+'</p></div><button class="'+e+'-close" aria-label="닫기">&times;</button>',this.elements.body=document.createElement("div"),this.elements.body.className=e+"-body",this.renderForm(),t.appendChild(i),t.appendChild(this.elements.body),this.elements.overlay.appendChild(t),this.elements.panel=t,this.config.hideButton||(this.elements.container.appendChild(this.elements.button),document.body.appendChild(this.elements.container)),document.body.appendChild(this.elements.overlay)}renderForm(){var e=this.cssPrefix,t=this;this.elements.body.innerHTML="",n.forEach(function(i){var n=document.createElement("div");n.className=e+"-field";var s=document.createElement("span");s.className=e+"-field-label",s.textContent=i.label,n.appendChild(s);var o=document.createElement("div");o.className=e+"-stars";for(var a=1;a<=5;a++)(function(n){var s=document.createElement("button");s.className=e+"-star",s.type="button",s.textContent=n,s.setAttribute("data-field",i.key),s.setAttribute("data-score",String(n)),s.addEventListener("click",function(){t.state.ratings[i.key]=n;for(var s=o.querySelectorAll("."+e+"-star"),a=0;a<s.length;a++)parseInt(s[a].getAttribute("data-score"),10)<=n?s[a].classList.add("selected"):s[a].classList.remove("selected");t.updateSubmitState()}),o.appendChild(s)})(a);n.appendChild(o),t.elements.body.appendChild(n)});var i=document.createElement("div");i.className=e+"-field";var s=document.createElement("span");s.className=e+"-field-label",s.textContent="추가 의견 (선택)",i.appendChild(s),this.elements.comment=document.createElement("textarea"),this.elements.comment.className=e+"-comment",this.elements.comment.placeholder="개선할 점이나 좋았던 점을 자유롭게 남겨주세요...",i.appendChild(this.elements.comment),this.elements.body.appendChild(i),this.elements.submitBtn=document.createElement("button"),this.elements.submitBtn.className=e+"-submit",this.elements.submitBtn.textContent="제출하기",this.elements.submitBtn.disabled=!0,this.elements.body.appendChild(this.elements.submitBtn)}updateSubmitState(){var e=n.every(function(e){return!!this.state.ratings[e.key]}.bind(this));this.elements.submitBtn&&(this.elements.submitBtn.disabled=!e||this.state.isSubmitting)}renderThanks(){var e=this.cssPrefix;this.elements.body.innerHTML='<div class="'+e+'-thanks"><div class="'+e+'-thanks-icon">&#x2705;</div><h3>감사합니다!</h3><p>소중한 의견이 접수되었습니다.<br>더 나은 서비스를 위해 노력하겠습니다.</p></div>'}bindEvents(){var e=this,t=this.cssPrefix;this.elements.button.addEventListener("click",function(){e.open()}),this.elements.overlay.querySelector("."+t+"-close").addEventListener("click",function(){e.close()}),this.elements.overlay.addEventListener("click",function(t){t.target===e.elements.overlay&&e.close()}),this.elements.submitBtn.addEventListener("click",function(){e.submit()})}open(){this.state.isOpen||(this.state.isOpen=!0,this.elements.overlay.classList.add("open"))}close(){this.state.isOpen&&(this.state.isOpen=!1,this.elements.overlay.classList.remove("open"),this.state.isSubmitted&&(this.state.isSubmitted=!1,this.state.ratings={},this.renderForm(),this.bindFormEvents()))}bindFormEvents(){var e=this;this.elements.submitBtn&&this.elements.submitBtn.addEventListener("click",function(){e.submit()})}async submit(){if(!this.state.isSubmitting){this.state.isSubmitting=!0,this.elements.submitBtn.disabled=!0,this.elements.submitBtn.textContent="제출 중...";try{var e={hospital_id:this.config.hospitalId,reservation_process:this.state.ratings.reservation_process,facility_cleanliness:this.state.ratings.facility_cleanliness,staff_kindness:this.state.ratings.staff_kindness,waiting_time:this.state.ratings.waiting_time,overall_satisfaction:this.state.ratings.overall_satisfaction,free_comment:this.elements.comment?this.elements.comment.value.trim():"",respondent_uuid:this.config.uuid},t=await fetch(this.config.baseUrl+"/welno-api/v1/hospital-survey/submit",{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":this.config.apiKey},body:JSON.stringify(e)});if(!t.ok){var i=await t.json().catch(function(){return{}});throw new Error(i.detail||"HTTP "+t.status)}this.state.isSubmitted=!0,this.renderThanks(),this.config.onSubmit&&this.config.onSubmit(e);var n=this;setTimeout(function(){n.close()},3e3)}catch(e){console.error("[WelnoSurveyWidget] 제출 실패:",e),this.config.onError&&this.config.onError(e),this.elements.submitBtn.textContent="제출 실패 - 다시 시도",this.elements.submitBtn.disabled=!1}finally{this.state.isSubmitting=!1}}}destroy(){this.elements.container&&this.elements.container.parentNode&&this.elements.container.parentNode.removeChild(this.elements.container),this.elements.overlay&&this.elements.overlay.parentNode&&this.elements.overlay.parentNode.removeChild(this.elements.overlay);var e=document.getElementById(this.cssPrefix+"-styles");e&&e.remove(),this.state.isInitialized=!1}}s.create=function(e){var t=new s(e);return t.init(),t},e.exports?(e.exports=s,e.exports.default=s):void 0===(i=function(){return s}.apply(t,[]))||(e.exports=i)}},t={},function i(n){var s=t[n];if(void 0!==s)return s.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,i),o.exports}(565).default;var e,t});