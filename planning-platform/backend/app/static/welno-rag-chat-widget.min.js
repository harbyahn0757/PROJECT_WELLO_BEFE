!function(n,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.WelnoRagChatWidget=e():n.WelnoRagChatWidget=e()}(this,()=>{return n={803(n,e){var t,s={"5a9bb40b5108ecd8ef864658d5a2d5ab":"/welno-api/static/mdx_icon.png"};class i{constructor(n){if(!n.apiKey)throw new Error("WelnoRagChatWidget: apiKey is required");var e=n.baseUrl||"http://localhost:8082",t=n.chatIconUrl||null;!t&&n.apiKey&&s[n.apiKey]&&(t=e.replace(/\/$/,"")+s[n.apiKey]),this.config={apiKey:n.apiKey,baseUrl:e,uuid:n.uuid||"widget_user_"+Date.now(),hospitalId:n.hospitalId||"widget_partner",partnerData:n.partnerData||null,position:n.position||"bottom-right",theme:n.theme||"default",buttonColor:n.buttonColor||"#A69B8F",chatIconUrl:t,autoOpen:n.autoOpen||!1,welcomeMessage:n.welcomeMessage||"ÏïàÎÖïÌïòÏÑ∏Ïöî! Í±¥Í∞ïÍ≥º ÏòÅÏñëÏóê ÎåÄÌï¥ Í∂ÅÍ∏àÌïú Ï†êÏùÑ Î¨ºÏñ¥Î≥¥ÏÑ∏Ïöî. üòä",onOpen:n.onOpen||null,onClose:n.onClose||null,onMessage:n.onMessage||null,onError:n.onError||null},this.state={isOpen:!1,isLoading:!1,messages:[],sessionId:null,suggestions:[],isInitialized:!1},this.elements={container:null,button:null,window:null,messagesContainer:null,input:null,sendButton:null},this.cssPrefix="welno-rag-widget",console.log("[WelnoRagChatWidget] Ï¥àÍ∏∞Ìôî ÏôÑÎ£å:",this.config)}init(){if(this.state.isInitialized)console.warn("[WelnoRagChatWidget] Ïù¥ÎØ∏ Ï¥àÍ∏∞ÌôîÎê®");else try{this.injectStyles(),this.createDOM(),this.bindEvents(),this.state.sessionId="temp_".concat(this.config.uuid,"_").concat(Date.now()),this.warmup(),this.addMessage("assistant",this.config.welcomeMessage),this.config.autoOpen&&setTimeout(()=>this.open(),500),this.state.isInitialized=!0,console.log("[WelnoRagChatWidget] Ï¥àÍ∏∞Ìôî ÏôÑÎ£å")}catch(n){console.error("[WelnoRagChatWidget] Ï¥àÍ∏∞Ìôî Ïã§Ìå®:",n),this.handleError("ÏúÑÏ†Ø Ï¥àÍ∏∞ÌôîÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.",n)}}injectStyles(){const n="".concat(this.cssPrefix,"-styles");if(document.getElementById(n))return;const e="\n      /* Welno RAG Chat Widget Styles */\n      .".concat(this.cssPrefix,"-container {\n        position: fixed;\n        z-index: 9999;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n        font-size: 14px;\n        line-height: 1.4;\n        color: #333;\n        box-sizing: border-box;\n      }\n      \n      .").concat(this.cssPrefix,"-container *,\n      .").concat(this.cssPrefix,"-container *::before,\n      .").concat(this.cssPrefix,"-container *::after {\n        box-sizing: border-box;\n      }\n\n      /* ÏúÑÏπòÎ≥Ñ Ïä§ÌÉÄÏùº */\n      .").concat(this.cssPrefix,"-container.position-bottom-right {\n        bottom: 24px;\n        right: 24px;\n      }\n      \n      .").concat(this.cssPrefix,"-container.position-bottom-left {\n        bottom: 24px;\n        left: 24px;\n      }\n      \n      .").concat(this.cssPrefix,"-container.position-top-right {\n        top: 24px;\n        right: 24px;\n      }\n      \n      .").concat(this.cssPrefix,"-container.position-top-left {\n        top: 24px;\n        left: 24px;\n      }\n\n      /* Ï±ÑÌåÖ Î≤ÑÌäº */\n      .").concat(this.cssPrefix,"-button {\n        width: 56px;\n        height: 56px;\n        border-radius: 50%;\n        background: ").concat(this.config.buttonColor,";\n        color: white;\n        border: none;\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all 0.3s ease;\n        outline: none;\n      }\n\n      .").concat(this.cssPrefix,"-button:hover {\n        transform: scale(1.1);\n        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);\n        filter: brightness(0.9);\n      }\n\n      .").concat(this.cssPrefix,"-button.active {\n        filter: brightness(0.9);\n      }\n\n      /* ÌååÌä∏ÎÑà ÏïÑÏù¥ÏΩò: Ïù¥ÎØ∏ÏßÄÏùº ÎïåÎäî ÏõêÌòï Î≤ÑÌäº Ï†ÑÏ≤¥Î•º Ï±ÑÏõÄ, SVGÎäî 24x24 Ïú†ÏßÄ */\n      .").concat(this.cssPrefix,"-button .").concat(this.cssPrefix,"-icon-slot {\n        width: 100%;\n        height: 100%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        flex-shrink: 0;\n        border-radius: 50%;\n        overflow: hidden;\n      }\n      .").concat(this.cssPrefix,"-button .").concat(this.cssPrefix,"-icon-slot svg {\n        width: 24px;\n        height: 24px;\n        flex-shrink: 0;\n        display: block;\n      }\n      .").concat(this.cssPrefix,"-button .").concat(this.cssPrefix,"-icon-slot img {\n        width: 100%;\n        height: 100%;\n        object-fit: cover;\n        object-position: center;\n        display: block;\n      }\n\n      /* Ï±ÑÌåÖ Ï∞Ω */\n      .").concat(this.cssPrefix,"-window {\n        position: absolute;\n        bottom: 70px;\n        right: 0;\n        width: 360px;\n        height: 550px;\n        background: #FFFAF2;\n        border-radius: 20px;\n        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);\n        display: none;\n        flex-direction: column;\n        overflow: hidden;\n        border: 1px solid rgba(123, 94, 79, 0.1);\n        animation: slideInUp 0.3s ease-out;\n      }\n\n      .").concat(this.cssPrefix,"-window.open {\n        display: flex;\n      }\n\n      .").concat(this.cssPrefix,"-container.position-bottom-left .").concat(this.cssPrefix,"-window {\n        right: auto;\n        left: 0;\n      }\n\n      .").concat(this.cssPrefix,"-container.position-top-right .").concat(this.cssPrefix,"-window {\n        bottom: auto;\n        top: 70px;\n      }\n\n      .").concat(this.cssPrefix,"-container.position-top-left .").concat(this.cssPrefix,"-window {\n        bottom: auto;\n        top: 70px;\n        right: auto;\n        left: 0;\n      }\n\n      @keyframes slideInUp {\n        from {\n          transform: translateY(20px);\n          opacity: 0;\n        }\n        to {\n          transform: translateY(0);\n          opacity: 1;\n        }\n      }\n\n      /* Ìó§Îçî */\n      .").concat(this.cssPrefix,"-header {\n        background: #7B5E4F;\n        color: white;\n        padding: 18px 20px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n      }\n\n      .").concat(this.cssPrefix,"-header h3 {\n        margin: 0;\n        font-size: 17px;\n        font-weight: 600;\n        letter-spacing: -0.5px;\n      }\n\n      .").concat(this.cssPrefix,"-close-button {\n        background: none;\n        border: none;\n        color: white;\n        font-size: 20px;\n        cursor: pointer;\n        padding: 4px;\n        border-radius: 4px;\n        transition: background-color 0.2s;\n      }\n\n      .").concat(this.cssPrefix,"-close-button:hover {\n        background: rgba(255, 255, 255, 0.1);\n      }\n\n      /* Ïõ∞Ïª¥ Î≤ÑÎ∏î (Îß§Î†•Ï†ÅÏù∏ ÎßêÌíçÏÑ†) - Î™®Î∞îÏùºÏóêÏÑú Í∏∏Î©¥ Îëê Ï§ÑÎ°ú Ï§ÑÎ∞îÍøà */\n      .").concat(this.cssPrefix,"-welcome-bubble {\n        position: absolute;\n        bottom: 70px;\n        right: 0;\n        background: white;\n        padding: 12px 18px;\n        border-radius: 16px;\n        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);\n        border: 1px solid #7B5E4F;\n        max-width: 260px;\n        white-space: normal;\n        word-break: keep-all;\n        opacity: 0;\n        transform: translateY(10px);\n        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);\n        pointer-events: none;\n        cursor: pointer;\n        z-index: 9998;\n      }\n\n      .").concat(this.cssPrefix,"-welcome-bubble.visible {\n        opacity: 1;\n        transform: translateY(0);\n        pointer-events: auto;\n      }\n\n      .").concat(this.cssPrefix,"-welcome-bubble::after {\n        content: '';\n        position: absolute;\n        bottom: -8px;\n        right: 20px;\n        width: 0;\n        height: 0;\n        border-left: 8px solid transparent;\n        border-right: 8px solid transparent;\n        border-top: 8px solid #7B5E4F;\n      }\n\n      .").concat(this.cssPrefix,"-welcome-bubble::before {\n        content: '';\n        position: absolute;\n        bottom: -6px;\n        right: 21px;\n        width: 0;\n        height: 0;\n        border-left: 7px solid transparent;\n        border-right: 7px solid transparent;\n        border-top: 7px solid white;\n        z-index: 1;\n      }\n\n      .").concat(this.cssPrefix,"-welcome-bubble-text {\n        font-weight: 500;\n        color: #7B5E4F;\n        font-size: 13px;\n        line-height: 1.4;\n      }\n      @media (max-width: 480px) {\n        .").concat(this.cssPrefix,"-welcome-bubble {\n          max-width: calc(100vw - 100px);\n        }\n      }\n\n      @keyframes bubbleBounce {\n        0%, 100% { transform: translateY(0); }\n        50% { transform: translateY(-5px); }\n      }\n\n      .").concat(this.cssPrefix,"-welcome-bubble.visible {\n        animation: bubbleBounce 3s infinite ease-in-out;\n      }\n\n      /* Î©îÏãúÏßÄ ÏòÅÏó≠ */\n      .").concat(this.cssPrefix,"-messages {\n        flex: 1;\n        overflow-y: auto;\n        padding: 20px;\n        background: #FFFAF2;\n      }\n\n      .").concat(this.cssPrefix,"-message {\n        margin-bottom: 16px;\n        display: flex;\n        flex-direction: column;\n      }\n\n      .").concat(this.cssPrefix,"-message.user {\n        align-items: flex-end;\n      }\n\n      .").concat(this.cssPrefix,"-message.assistant {\n        align-items: flex-start;\n      }\n\n      .").concat(this.cssPrefix,"-message-bubble {\n        max-width: 80%;\n        padding: 12px 16px;\n        border-radius: 18px;\n        word-wrap: break-word;\n        line-height: 1.4;\n      }\n\n      .").concat(this.cssPrefix,"-message.user .").concat(this.cssPrefix,"-message-bubble {\n        background: #7B5E4F;\n        color: white;\n        border-bottom-right-radius: 6px;\n      }\n\n      .").concat(this.cssPrefix,"-message.assistant .").concat(this.cssPrefix,"-message-bubble {\n        background: white;\n        color: #333;\n        border: 1px solid #E5E5E5;\n        border-bottom-left-radius: 6px;\n      }\n\n      .").concat(this.cssPrefix,"-message-time {\n        font-size: 11px;\n        color: #999;\n        margin-top: 4px;\n        padding: 0 4px;\n      }\n\n      /* Î°úÎî© Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ */\n      .").concat(this.cssPrefix,"-loading {\n        display: flex;\n        align-items: center;\n        padding: 12px 16px;\n        background: white;\n        border: 1px solid #E5E5E5;\n        border-radius: 18px;\n        border-bottom-left-radius: 6px;\n        max-width: 80%;\n      }\n\n      .").concat(this.cssPrefix,"-loading-dots {\n        display: flex;\n        gap: 4px;\n      }\n\n      .").concat(this.cssPrefix,"-loading-dot {\n        width: 8px;\n        height: 8px;\n        border-radius: 50%;\n        background: #999;\n        animation: loadingDot 1.4s infinite ease-in-out both;\n      }\n\n      .").concat(this.cssPrefix,"-loading-dot:nth-child(1) { animation-delay: -0.32s; }\n      .").concat(this.cssPrefix,"-loading-dot:nth-child(2) { animation-delay: -0.16s; }\n\n      @keyframes loadingDot {\n        0%, 80%, 100% {\n          transform: scale(0);\n        }\n        40% {\n          transform: scale(1);\n        }\n      }\n\n      /* ÏûÖÎ†• ÏòÅÏó≠ */\n      .").concat(this.cssPrefix,"-input-area {\n        padding: 16px 20px;\n        background: white;\n        border-top: 1px solid #E5E5E5;\n        display: flex;\n        gap: 12px;\n        align-items: flex-end;\n      }\n\n      .").concat(this.cssPrefix,"-input {\n        flex: 1;\n        border: 1px solid #E5E5E5;\n        border-radius: 20px;\n        padding: 10px 16px;\n        font-size: 14px;\n        outline: none;\n        resize: none;\n        min-height: 20px;\n        max-height: 100px;\n        font-family: inherit;\n      }\n\n      .").concat(this.cssPrefix,"-input:focus {\n        border-color: #7B5E4F;\n      }\n\n      .").concat(this.cssPrefix,"-send-button {\n        width: 40px;\n        height: 40px;\n        border-radius: 50%;\n        background: #7B5E4F;\n        color: white;\n        border: none;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: background-color 0.2s;\n        flex-shrink: 0;\n      }\n\n      .").concat(this.cssPrefix,"-send-button:hover {\n        background: #6B4E3F;\n      }\n\n      .").concat(this.cssPrefix,"-send-button:disabled {\n        background: #CCC;\n        cursor: not-allowed;\n      }\n\n      .").concat(this.cssPrefix,"-send-button svg {\n        width: 16px;\n        height: 16px;\n      }\n\n      /* Î∞òÏùëÌòï */\n      @media (max-width: 480px) {\n        .").concat(this.cssPrefix,"-window {\n          width: calc(100vw - 24px);\n          height: calc(100vh - 100px);\n          max-width: 360px;\n          max-height: 550px;\n        }\n      }\n\n      /* ÏÜåÏä§ ÌëúÏãú */\n      .").concat(this.cssPrefix,"-sources {\n        margin-top: 8px;\n        font-size: 12px;\n        color: #666;\n      }\n\n      .").concat(this.cssPrefix,"-source {\n        display: inline-block;\n        background: #F0F0F0;\n        padding: 2px 6px;\n        border-radius: 4px;\n        margin: 2px 4px 2px 0;\n      }\n\n      /* Ï†úÏïà ÏßàÎ¨∏ */\n      .").concat(this.cssPrefix,"-suggestions {\n        margin-top: 12px;\n        display: flex;\n        flex-wrap: wrap;\n        gap: 8px;\n      }\n\n      .").concat(this.cssPrefix,"-suggestion {\n        background: #F8F8F8;\n        border: 1px solid #E5E5E5;\n        border-radius: 16px;\n        padding: 6px 12px;\n        font-size: 12px;\n        cursor: pointer;\n        transition: all 0.2s;\n      }\n\n      .").concat(this.cssPrefix,"-suggestion:hover {\n        background: #7B5E4F;\n        color: white;\n        border-color: #7B5E4F;\n      }\n    "),t=document.createElement("style");t.id=n,t.textContent=e,document.head.appendChild(t)}createDOM(){this.elements.container=document.createElement("div"),this.elements.container.className="".concat(this.cssPrefix,"-container position-").concat(this.config.position),this.elements.button=document.createElement("button"),this.elements.button.className="".concat(this.cssPrefix,"-button"),this.elements.button.innerHTML=this.getChatIcon(),this.elements.button.setAttribute("aria-label","Ï±ÑÌåÖ Ïó¥Í∏∞"),this.elements.welcomeBubble=document.createElement("div"),this.elements.welcomeBubble.className="".concat(this.cssPrefix,"-welcome-bubble"),this.elements.welcomeBubble.innerHTML='<div class="'.concat(this.cssPrefix,'-welcome-bubble-text">Î∂ÑÏÑù Ï§ë...</div>'),this.elements.window=document.createElement("div"),this.elements.window.className="".concat(this.cssPrefix,"-window");const n=document.createElement("div");n.className="".concat(this.cssPrefix,"-header"),n.innerHTML='\n      <h3>Dr. Welno</h3>\n      <button class="'.concat(this.cssPrefix,'-close-button" aria-label="Ï±ÑÌåÖ Îã´Í∏∞">√ó</button>\n    '),this.elements.messagesContainer=document.createElement("div"),this.elements.messagesContainer.className="".concat(this.cssPrefix,"-messages");const e=document.createElement("div");e.className="".concat(this.cssPrefix,"-input-area"),this.elements.input=document.createElement("textarea"),this.elements.input.className="".concat(this.cssPrefix,"-input"),this.elements.input.placeholder="Î©îÏãúÏßÄÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî...",this.elements.input.rows=1,this.elements.sendButton=document.createElement("button"),this.elements.sendButton.className="".concat(this.cssPrefix,"-send-button"),this.elements.sendButton.innerHTML=this.getSendIcon(),this.elements.sendButton.setAttribute("aria-label","Î©îÏãúÏßÄ Ï†ÑÏÜ°"),e.appendChild(this.elements.input),e.appendChild(this.elements.sendButton),this.elements.window.appendChild(n),this.elements.window.appendChild(this.elements.messagesContainer),this.elements.window.appendChild(e),this.elements.container.appendChild(this.elements.welcomeBubble),this.elements.container.appendChild(this.elements.button),this.elements.container.appendChild(this.elements.window),document.body.appendChild(this.elements.container)}bindEvents(){this.elements.button.addEventListener("click",()=>{this.state.isOpen?this.close():this.open()}),this.elements.welcomeBubble.addEventListener("click",()=>{this.open(),this.elements.welcomeBubble.classList.remove("visible")}),this.elements.window.querySelector(".".concat(this.cssPrefix,"-close-button")).addEventListener("click",()=>this.close()),this.elements.sendButton.addEventListener("click",()=>this.sendMessage()),this.elements.input.addEventListener("keydown",n=>{"Enter"!==n.key||n.shiftKey||(n.preventDefault(),this.sendMessage())}),this.elements.input.addEventListener("input",()=>{this.elements.input.style.height="auto",this.elements.input.style.height=Math.min(this.elements.input.scrollHeight,100)+"px"}),document.addEventListener("click",n=>{this.state.isOpen&&this.elements.container.contains(n.target)})}open(){this.state.isOpen||(this.state.isOpen=!0,this.elements.window.classList.add("open"),this.elements.button.classList.add("active"),this.elements.button.innerHTML=this.getCloseIcon(),this.elements.welcomeBubble&&this.elements.welcomeBubble.classList.remove("visible"),setTimeout(()=>{this.elements.input.focus()},300),this.config.onOpen&&this.config.onOpen(),console.log("[WelnoRagChatWidget] Ï±ÑÌåÖÏ∞Ω Ïó¥Î¶º"))}close(){this.state.isOpen&&(this.state.isOpen=!1,this.elements.window.classList.remove("open"),this.elements.button.classList.remove("active"),this.elements.button.innerHTML=this.getChatIcon(),this.config.onClose&&this.config.onClose(),console.log("[WelnoRagChatWidget] Ï±ÑÌåÖÏ∞Ω Îã´Ìûò"))}async sendMessage(){const n=this.elements.input.value.trim();if(n&&!this.state.isLoading)try{this.addMessage("user",n),this.elements.input.value="",this.elements.input.style.height="auto",this.setLoading(!0),await this.callPartnerAPI(n)}catch(n){console.error("[WelnoRagChatWidget] Î©îÏãúÏßÄ Ï†ÑÏÜ° Ïã§Ìå®:",n),"AbortError"===n.name?this.handleError("ÏùëÎãµ ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§. Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.",n):this.handleError("Î©îÏãúÏßÄ Ï†ÑÏÜ°Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.",n)}finally{this.setLoading(!1)}}async callPartnerAPI(n){const e={uuid:this.config.uuid,hospital_id:this.config.hospitalId,message:n,session_id:this.state.sessionId};this.config.partnerData&&(e.health_data=this.config.partnerData);const t=new AbortController,s=setTimeout(()=>t.abort(),3e4),i=await fetch("".concat(this.config.baseUrl,"/welno-api/v1/rag-chat/partner/message"),{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":this.config.apiKey},body:JSON.stringify(e),signal:t.signal});if(clearTimeout(s),!i.ok){const n=await i.json().catch(()=>({}));throw new Error(n.detail||"HTTP ".concat(i.status,": ").concat(i.statusText))}await this.handleStreamingResponse(i)}async handleStreamingResponse(n){const e=n.body.getReader(),t=new TextDecoder;let s="",i=null;try{for(;;){const{done:n,value:o}=await e.read();if(n)break;const a=t.decode(o,{stream:!0}).split("\n");for(const n of a)if(n.startsWith("data: "))try{const e=JSON.parse(n.slice(6));e.answer&&(s+=e.answer,i||(i=this.addMessage("assistant","")),this.updateMessageContent(i,s)),e.done&&(e.sources&&e.sources.length>0&&this.addSources(i,e.sources),e.suggestions&&e.suggestions.length>0&&this.addSuggestions(i,e.suggestions))}catch(e){console.warn("[WelnoRagChatWidget] JSON ÌååÏã± Ïã§Ìå®:",n)}}}finally{e.releaseLock()}}addMessage(n,e){const t=document.createElement("div");t.className="".concat(this.cssPrefix,"-message ").concat(n);const s=document.createElement("div");s.className="".concat(this.cssPrefix,"-message-bubble"),s.textContent=e;const i=document.createElement("div");return i.className="".concat(this.cssPrefix,"-message-time"),i.textContent=(new Date).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"}),t.appendChild(s),t.appendChild(i),this.elements.messagesContainer.appendChild(t),this.scrollToBottom(),this.state.messages.push({role:n,content:e,timestamp:(new Date).toISOString()}),this.config.onMessage&&this.config.onMessage({role:n,content:e}),t}updateMessageContent(n,e){n.querySelector(".".concat(this.cssPrefix,"-message-bubble")).textContent=e,this.scrollToBottom()}addSources(n,e){const t=document.createElement("div");t.className="".concat(this.cssPrefix,"-sources"),e.slice(0,3).forEach(n=>{const e=document.createElement("span");e.className="".concat(this.cssPrefix,"-source"),e.textContent=n.title||"Ï∞∏Í≥†ÏûêÎ£å",e.title=n.text.substring(0,100)+"...",t.appendChild(e)}),n.appendChild(t)}addSuggestions(n,e){if(!e||0===e.length)return;const t=document.createElement("div");t.className="".concat(this.cssPrefix,"-suggestions"),e.slice(0,3).forEach(n=>{const e=document.createElement("button");e.className="".concat(this.cssPrefix,"-suggestion"),e.textContent=n,e.addEventListener("click",()=>{this.elements.input.value=n,this.elements.input.focus()}),t.appendChild(e)}),n.appendChild(t)}setLoading(n){if(this.state.isLoading=n,this.elements.sendButton.disabled=n,n){const n=this.config.partnerData&&this.config.partnerData.patient&&this.config.partnerData.patient.name?this.config.partnerData.patient.name:"Í≥†Í∞ù",e=document.createElement("div");e.className="".concat(this.cssPrefix,"-message assistant"),e.innerHTML='\n        <div class="'.concat(this.cssPrefix,'-loading">\n          <div class="').concat(this.cssPrefix,'-loading-dots">\n            <div class="').concat(this.cssPrefix,'-loading-dot"></div>\n            <div class="').concat(this.cssPrefix,'-loading-dot"></div>\n            <div class="').concat(this.cssPrefix,'-loading-dot"></div>\n          </div>\n          <span style="display: block; margin-top: 8px; color: #333; font-size: 13px; font-weight: 500; text-align: center;">ÎãµÎ≥ÄÏùÑ ÏûëÏÑ±Ï§ëÏù¥ÏóêÏöî</span>\n          <span style="display: block; margin-top: 4px; color: #666; font-size: 12px; text-align: center;">').concat(n,"ÎãòÏùò Îç∞Ïù¥ÌÑ∞Î•º Ïù¥Ïö©Ìï¥ÏÑú Í≤ÄÏßÑ Í≤∞Í≥ºÎ•º ÏùΩÏñ¥ ÎìúÎ¶¥ÍªòÏöî</span>\n        </div>\n      "),e.id="loading-indicator",this.elements.messagesContainer.appendChild(e),this.scrollToBottom()}else{const n=document.getElementById("loading-indicator");n&&n.remove()}}scrollToBottom(){setTimeout(()=>{this.elements.messagesContainer.scrollTop=this.elements.messagesContainer.scrollHeight},100)}handleError(n,e){console.error("[WelnoRagChatWidget] ÏóêÎü¨:",e),this.addMessage("assistant","Ï£ÑÏÜ°Ìï©ÎãàÎã§. ".concat(n)),this.config.onError&&this.config.onError(e)}getChatIcon(){const n="".concat(this.cssPrefix,"-icon-slot");return this.config.chatIconUrl?'<span class="'.concat(n,'"><img src="').concat(this.config.chatIconUrl,'" alt="Ï±ÑÌåÖ Ïó¥Í∏∞" /></span>'):'\n      <span class="'.concat(n,'">\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">\n          <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n        </svg>\n      </span>\n    ')}getCloseIcon(){return'\n      <svg width="24" height="24" viewBox="0 0 24 24" fill="none">\n        <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>\n      </svg>\n    '}getSendIcon(){return'\n      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">\n        <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n      </svg>\n    '}async warmup(){if(this.config.partnerData)try{const n=await fetch("".concat(this.config.baseUrl,"/welno-api/v1/rag-chat/partner/warmup"),{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":this.config.apiKey},body:JSON.stringify({uuid:this.config.uuid,hospital_id:this.config.hospitalId,health_data:this.config.partnerData})});if(n.ok){const e=await n.json();if(e.session_id&&(this.state.sessionId=e.session_id,console.log("[WelnoRagChatWidget] ÏÑ∏ÏÖò ÎèôÍ∏∞Ìôî ÏôÑÎ£å:",this.state.sessionId)),e.greeting){const n=(e.greeting||"").replace(/\s*\n\s*/g," ").trim();this.elements.welcomeBubble.querySelector(".".concat(this.cssPrefix,"-welcome-bubble-text")).textContent=n,setTimeout(()=>{this.state.isOpen||this.elements.welcomeBubble.classList.add("visible")},1e3)}}}catch(n){console.warn("[WelnoRagChatWidget] ÏõúÏóÖ Ïã§Ìå®:",n)}}destroy(){this.elements.container&&this.elements.container.parentNode&&this.elements.container.parentNode.removeChild(this.elements.container);const n=document.getElementById("".concat(this.cssPrefix,"-styles"));n&&!document.querySelector(".".concat(this.cssPrefix,"-container"))&&n.remove(),this.state.isInitialized=!1,console.log("[WelnoRagChatWidget] ÏúÑÏ†Ø Ï†úÍ±∞Îê®")}}n.exports?(n.exports=i,n.exports.default=i):void 0===(t=function(){return i}.apply(e,[]))||(n.exports=t),console.log("[WelnoRagChatWidget] Î°úÎìú ÏôÑÎ£å")}},e={},function t(s){var i=e[s];if(void 0!==i)return i.exports;var o=e[s]={exports:{}};return n[s](o,o.exports,t),o.exports}(803).default;var n,e});