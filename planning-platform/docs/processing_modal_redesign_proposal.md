# ProcessingModal 리디자인 제안서

## 📋 개요
STEP 1 응답을 모달 하단에 슬라이드 카드 형식으로 표시하고, 하이라이트 처리를 추가하여 사용자 경험을 개선합니다.

## 🎨 화면 구성 제안

### 레이아웃 구조
```
┌─────────────────────────────────────┐
│  ProcessingModal                    │
├─────────────────────────────────────┤
│  [헤더]                             │
│  - 제목: "AI 분석 중"               │
│                                     │
│  [스피너 영역 - 상단 고정]          │
│  ┌─────────────────────────────┐   │
│  │  🔄 웰로 로고 (회전)        │   │
│  │  "최신 의학 논문 검색 중..." │   │
│  └─────────────────────────────┘   │
│                                     │
│  [프로그레스 바]                     │
│  ▓▓▓▓▓▓▓▓░░░░░░░░░░░░░░░░ 50%      │
│                                     │
│  [STEP 1 결과 영역 - 하단 고정]     │
│  ┌─────────────────────────────┐   │
│  │ 📋 분석 결과 카드 (슬라이드) │   │
│  │ ─────────────────────────── │   │
│  │                             │   │
│  │ 📋 문진 반영 내용:          │   │
│  │ 문진에서 확인된 {highlight} │   │
│  │ 가족력(심장질환, 뇌졸중){/  │   │
│  │ highlight}을 고려하여...    │   │
│  │                             │   │
│  │ 📌 선택하신 항목 분석:      │   │
│  │ 1. 건강검진 (09/28)         │   │
│  │    추이 분석: ...           │   │
│  │    설계 반영: ...           │   │
│  │                             │   │
│  │ [◀ 1/2 ▶]                  │   │
│  └─────────────────────────────┘   │
│                                     │
│  [진행 단계 리스트]                 │
│  ✓ 최신 의학 논문 검색             │
│  ⟳ 건강검진 가이드라인 참조 중...  │
│  ○ 환자 데이터 종합 분석            │
└─────────────────────────────────────┘
```

## 🎯 주요 개선 사항

### 1. 스피너 영역 (상단 고정)
- **위치**: 모달 상단, 헤더 바로 아래
- **크기**: 고정 높이 (120px)
- **내용**: 
  - 웰로 로고 (회전 애니메이션)
  - 현재 단계 thinking 텍스트
- **스타일**: 
  - 배경: `$white`
  - 패딩: `$spacing-lg`
  - 중앙 정렬

### 2. STEP 1 결과 영역 (하단 고정)
- **위치**: 스피너 하단, 프로그레스 바 위
- **크기**: 고정 높이 (최대 300px, 스크롤 가능)
- **형식**: 슬라이드 카드 형식
- **내용**:
  - 카드 1: 문진 반영 내용 (`survey_reflection`)
  - 카드 2: 선택 항목 분석 (`selected_concerns_analysis`)
- **스타일**:
  - 배경: `$gray-50`
  - 테두리: `1px solid $gray-200`
  - 둥근 모서리: `$border-radius-lg`
  - 패딩: `$spacing-md`
  - 그림자: `$shadow-sm`

### 3. 하이라이트 처리
- **태그 형식**: `{highlight}텍스트{/highlight}`
- **스타일**:
  - 배경: `$brand-brown-light` (rgba(124, 116, 106, 0.1))
  - 텍스트: `$brand-brown-dark`
  - 패딩: `2px 4px`
  - 둥근 모서리: `$border-radius-sm`
  - 폰트 굵기: `$font-weight-semibold`

### 4. 슬라이드 카드 네비게이션
- **인디케이터**: 하단 점 표시 (● ○)
- **이전/다음 버튼**: 좌우 화살표 (◀ ▶)
- **애니메이션**: 부드러운 슬라이드 전환 (300ms)

## 📐 디자인 토큰 사용

### 색상
```scss
// 배경
$white: #ffffff;
$gray-50: #fafafa;
$gray-200: #e5e5e5;

// 텍스트
$gray-800: #262626;
$brand-brown-dark: #696158;

// 하이라이트
$brand-brown-light: rgba(124, 116, 106, 0.1);
```

### 간격
```scss
$spacing-xs: 4px;
$spacing-sm: 8px;
$spacing-md: 16px;
$spacing-lg: 24px;
$spacing-xl: 32px;
```

### 둥근 모서리
```scss
$border-radius-sm: 4px;
$border-radius-md: 8px;
$border-radius-lg: 12px;
$border-radius-xl: 16px;
```

## 🔧 구현 계획

### Phase 1: 레이아웃 재구성
1. 스피너 영역 상단 고정
2. STEP 1 결과 영역 하단 고정
3. 반응형 높이 조정

### Phase 2: 슬라이드 카드 구현
1. 카드 컴포넌트 생성
2. 슬라이드 네비게이션 추가
3. 애니메이션 효과 적용

### Phase 3: 하이라이트 처리
1. 텍스트 파싱 함수 생성
2. 하이라이트 스타일 적용
3. 타이핑 효과와 통합

### Phase 4: STEP 2 속도 개선
1. 프롬프트 최적화 검토
2. 모델 선택 재검토
3. 병렬 처리 가능 여부 확인

## 🚀 STEP 2 속도 개선 방안

### 현재 문제점
- STEP 1과 STEP 2가 순차적으로 실행됨
- STEP 2가 더 강력한 모델(`sonar-pro`)을 사용하여 느림
- 프롬프트가 길어서 처리 시간 증가

### 개선 방안

#### 옵션 1: STEP 2 프롬프트 최적화
- STEP 1 결과를 요약하여 전달
- 불필요한 중복 정보 제거
- 핵심 정보만 추출

#### 옵션 2: 모델 선택 재검토
- STEP 2도 `sonar` 모델 사용 (빠른 응답)
- 또는 `sonar`와 `sonar-pro` 병렬 호출 후 병합

#### 옵션 3: 프롬프트 분할
- STEP 2를 2단계로 분할:
  - STEP 2-1: 검진 항목 선정 (빠른 모델)
  - STEP 2-2: 의학적 근거 확보 (강력한 모델)

## 📝 다음 단계
1. 화면 구성 제안 검토
2. 디자인 가이드 준수 확인
3. 구현 시작

