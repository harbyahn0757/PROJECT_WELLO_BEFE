@use './styles/variables' as *;
@use './styles/mixins' as *;

// App 로딩 스타일
.app-loading {
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  background: $background-beige;
  
  .loading-spinner {
    padding: $spacing-lg;
    font-size: $font-lg;
    color: $gray-600;
    text-align: center;
    
    &::after {
      content: '';
      display: inline-block;
      width: 20px;
      height: 20px;
      margin-left: $spacing-sm;
      border: 2px solid transparent;
      border-top: 2px solid $brand-brown;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      vertical-align: middle;
    }
  }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

// 파비콘 블링크 애니메이션
@keyframes faviconBlink {
  0%, 100% { 
    opacity: 1; 
    transform: scale(1);
  }
  50% { 
    opacity: 0.3; 
    transform: scale(0.95);
  }
}

.favicon-blink-spinner {
  display: flex;
  justify-content: center;
  align-items: center;
}

// 앱 스타일
.app {
  border: none !important;
  border-bottom: none !important;
  border-top: none !important;
  border-left: none !important;
  border-right: none !important;
  outline: none !important;
  margin-bottom: 0 !important;
  padding-bottom: 0 !important;
  
  &::after,
  &::before {
    display: none !important;
    content: none !important;
    background: none !important;
    background-color: transparent !important;
    border: none !important;
    border-bottom: none !important;
    border-top: none !important;
    border-left: none !important;
    border-right: none !important;
    height: 0 !important;
    width: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
    box-shadow: none !important;
    outline: none !important;
  }
  min-height: 100vh;
  padding: 0;
  margin: 0;
  width: 100%;
  overflow-x: hidden; // 가로 스크롤 방지
  position: relative;
  background: #FEF9EE !important; // 전체 화면 배경색 (브라운 스킨)
  
  // 상단 여백 완전 제거
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 0;
    margin: 0;
    padding: 0;
  }
}

// 메인 컨테이너
.main-container {
  width: 100%;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  background: transparent; // MainPage에서 배경색 관리
  overflow-y: auto;
  overflow-x: hidden; // 가로 스크롤 방지
  position: relative;
  animation: pageFadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  border: none !important;
  border-bottom: none !important;
  border-top: none !important;
  border-left: none !important;
  border-right: none !important;
  outline: none !important;
  margin-bottom: 0 !important;
  padding-bottom: 0 !important;
  
  // 모바일: 전체 화면 사용, 둥글기 없음
  margin: 0;
  border-radius: 0;
  box-shadow: none;
  
  // 하단 하얀 줄 완전 제거
  &::after,
  &::before {
    display: none !important;
    content: none !important;
    background: none !important;
    background-color: transparent !important;
    border: none !important;
    border-bottom: none !important;
    border-top: none !important;
    border-left: none !important;
    border-right: none !important;
    height: 0 !important;
    width: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
    box-shadow: none !important;
    outline: none !important;
  }
  
  // 데스크톱: 중앙 정렬, 최대 너비 제한, 그림자 추가
  @include respond-to(md) {
    max-width: 448px;
    margin: 0 auto;
    border-radius: $border-radius-xl;
    box-shadow: $shadow-lg;
    max-height: 900px;
    height: auto; // 고정 높이 제거 (내용에 맞게 조정)
    min-height: 100vh; // 최소 높이 유지
    background: transparent; // 배경은 .app에서 처리
  }
}

// health-data-viewer가 포함된 main-container는 전체 폭 사용
// (스타일은 아래 :has() 선택자로 처리)

// results-trend 페이지의 main-container는 전체 폭 사용
body:has([href*="results-trend"]) .main-container,
.main-container:has(.health-data-viewer) {
  max-width: 100% !important;
  margin: 0 !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  
  @include respond-to(md) {
    max-width: 100% !important;
    margin: 0 !important;
    border-radius: 0 !important;
    box-shadow: none !important;
  }
}

// 배경 장식 요소
.bg-decoration {
  position: absolute;
  width: 256px; // w-64 (16rem = 256px)
  height: 256px; // h-64
  background-color: $brand-brown;
  border-radius: 50%;
  opacity: 0.1;
  filter: blur(48px); // blur-3xl
  z-index: -1;
  
  &--top {
    top: 25%; // top-1/4
    left: -96px; // -left-24 (6rem = 96px)
  }
  
  &--bottom {
    bottom: 25%; // bottom-1/4
    right: -96px; // -right-24
  }
}

// 헤더
.header {
  flex-shrink: 0;
  z-index: 10;
  position: relative;
  height: 208px; // h-52 (13rem = 208px)
  
  &__image {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
  }
  
  &__overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(to right, $background-beige, rgba(247, 232, 211, 0.8), transparent);
  }
  
  &__content {
    position: relative;
    z-index: 10;
    display: flex;
    flex-direction: column;
    justify-content: center;
    height: 100%;
    padding: $spacing-md $spacing-lg;
  }
  
  &__slogan {
    font-size: $font-sm;
    color: $gray-600;
    margin: 0 0 $spacing-xs 0;
  }
  
  &__logo {
    margin-top: $spacing-xs;
    
    &-title {
      font-size: $font-xl;
      font-weight: 700;
      color: $brand-brown;
      margin: 0;
    }
    
    &-subtitle {
      font-size: $font-xs;
      color: $gray-500;
      letter-spacing: 0.1em;
      margin: 0;
    }
  }
  
  &__main-title {
    font-size: $font-4xl;
    font-weight: 900;
    color: $gray-800;
    margin: $spacing-md 0 0 0;
  }
}

// 메인 콘텐츠
.main-content {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  padding: $spacing-sm $spacing-md $spacing-md;
  text-align: center;
  z-index: 10;
}

// 타이틀 섹션
.title-section {
  flex-shrink: 0;
  margin-bottom: $spacing-md;
  
  &__title {
    font-size: $font-2xl;
    font-weight: 700;
    color: $gray-800;
    line-height: 1.25;
    margin: 0 0 $spacing-xs 0;
  }
  
  &__subtitle {
    font-size: $font-sm;
    color: $gray-500;
    margin: 0;
  }
}

// AI 섹션
.ai-section {
  margin: $spacing-md 0;
  @include flex-center; // 중앙 정렬
}

// 카드 섹션 스타일은 Card.scss로 이동됨

// 건강 카드
.health-card {
  background: rgba(255, 255, 255, 0.8);
  backdrop-filter: blur(16px);
  padding: $spacing-md;
  border-radius: $border-radius-xl;
  box-shadow: $shadow-md;
  border: 1px solid $gray-100;
  border-left: 4px solid $brand-brown;
  display: flex;
  align-items: center;
  gap: $spacing-md;
  transition: box-shadow 0.3s ease;
  text-align: left;
  
  &:hover {
    box-shadow: $shadow-lg;
  }
  
  &__icon {
    width: 48px; // w-12 (3rem = 48px)
    height: 48px; // h-12
    border-radius: $border-radius-lg;
    background-color: $brand-brown-light;
    color: $brand-brown;
    flex-shrink: 0;
    @include flex-center;
    
    .icon {
      width: 28px; // w-7 (1.75rem = 28px)
      height: 28px; // h-7
    }
  }
  
  &__content {
    flex: 1;
  }
  
  &__title {
    font-size: $font-sm;
    font-weight: 700;
    color: $gray-800;
    margin: 0 0 $spacing-xs 0;
  }
  
  &__description {
    font-size: $font-xs;
    color: $gray-600;
    margin: 0;
    
    strong {
      color: $brand-brown;
      font-weight: 600;
    }
  }
}

// 하단 섹션
.footer-section {
  flex-shrink: 0;
  margin-top: auto;
  
  &__message {
    font-size: 10px; // 폰트 크기 대폭 축소
    color: $gray-600;
    font-weight: 500;
    margin: 0 0 $spacing-xs 0; // 하단 여백 축소
  }
  
  &__info {
    font-size: 9px; // 정보 텍스트 더 작게
    color: $gray-500;
    margin-bottom: $spacing-xs; // 하단 여백 축소
    
    p {
      margin: 0;
    }
  }
  
  &__spacing {
    height: 80px; // 플로팅 버튼을 위한 여백
  }
  
  // 가로형 레이아웃 전용 중간정렬
  &--horizontal {
    text-align: center;
    
    .footer-section__message {
      text-align: center;
    }
    
    .footer-section__info {
      text-align: center;
    }
  }
  
  // 가로형 레이아웃에서 푸터 간격 축소
  &--compact {
    margin-top: -$spacing-lg; // 위쪽 여백을 음수로 설정하여 더 위로
    
    .footer-section__message {
      margin-bottom: $spacing-xs; // 메시지 하단 여백 축소 (sm → xs)
    }
    
    .footer-section__info {
      margin-bottom: $spacing-xs; // 정보 하단 여백 축소 (sm → xs)
    }
  }
}

// 가로형 레이아웃 헤더 스타일
.horizontal-cards {
  &__title {
    font-size: $font-2xl;
    font-weight: 700;
    color: $gray-800;
    line-height: 1.2;
    text-align: center; // 중간 정렬
    margin: $spacing-md 0 $spacing-lg 0; // 간격 늘림
    
    // 환자명 강조 스타일
    .patient-name {
      font-size: $font-3xl; // 환자명만 더 크게
      font-weight: 800;
      color: $gray-900; // 조금 더 진한 색상
    }
  }
  
  &__subtitle {
    font-size: $font-sm;
    color: $gray-600;
    line-height: 1.6;
    text-align: center; // 중간 정렬
    margin: 0 0 $spacing-xl 0; // 하단 마진 늘림
    
    // 병원명 강조 스타일
    .hospital-name {
      color: $brand-brown;
      font-size: calc(#{$font-sm} + 1px); // 1px 더 크게
      font-weight: 600;
    }
  }
}

// 가로형 메시지 섹션 (카드 아래 영역)
.horizontal-message-section {
  margin: $spacing-lg 0;
  padding: $spacing-md;
  text-align: center;
  
  &__text {
    font-size: $font-sm;
    color: $gray-700;
    font-weight: 500;
    line-height: 1.6;
    margin: 0;
    
    // 첫 번째 줄 강조
    &::first-line {
      font-weight: 600;
      color: $gray-800;
    }
  }
}

// 플로팅 버튼 자체 스타일 (브라운 스킨) - solid 스타일
// Button 컴포넌트와 함께 사용되므로 더 구체적인 선택자 사용
// 메인화면 및 일반 페이지용 (인증 페이지 제외)
html body:not([data-path*="login"]) button.floating-button:not(.questionnaire-container .floating-button):not(.questionnaire-container.tilko-login .floating-button),
html body:not([data-path*="login"]) .button.floating-button:not(.questionnaire-container .floating-button):not(.questionnaire-container.tilko-login .floating-button),
html body:not([data-path*="login"]) .floating-button.button:not(.questionnaire-container .floating-button):not(.questionnaire-container.tilko-login .floating-button),
html body .main-container button.floating-button:not(.questionnaire-container .floating-button):not(.questionnaire-container.tilko-login .floating-button),
html body .main-container .button.floating-button:not(.questionnaire-container .floating-button):not(.questionnaire-container.tilko-login .floating-button),
html body .main-container .floating-button.button:not(.questionnaire-container .floating-button):not(.questionnaire-container.tilko-login .floating-button),
button.floating-button:not(.questionnaire-container .floating-button):not(.questionnaire-container.tilko-login .floating-button),
.button.floating-button:not(.questionnaire-container .floating-button):not(.questionnaire-container.tilko-login .floating-button),
.floating-button.button:not(.questionnaire-container .floating-button):not(.questionnaire-container.tilko-login .floating-button) {
  position: fixed !important;
  bottom: 0 !important; // 하단에 완전히 붙이기
  left: 0 !important; // 왼쪽부터 시작
  right: 0 !important; // 오른쪽까지 (스크롤바 영역 포함)
  width: 100vw !important; // 뷰포트 전체 너비 (스크롤바 포함)
  max-width: 100vw !important; // 최대 너비 제한 제거
  min-width: 100vw !important; // 최소 너비도 100vw
  min-height: $floating-button-height !important; // 버튼 높이 (상수 사용)
  height: auto !important; // 높이 자동 조정
  max-height: none !important; // 최대 높이 제한 제거
  background-color: $warning !important; // 버튼 색상 (주황색 토큰)
  color: #FFFFFF !important; // 흰색 폰트
  border: none !important; // 테두리 제거
  border-bottom: none !important; // 하단 테두리 완전 제거
  border-bottom-color: transparent !important; // border-bottom-color 명시적으로 transparent 설정
  border-top-color: transparent !important;
  border-left-color: transparent !important;
  border-right-color: transparent !important;
  outline: none !important; // 아웃라인 제거
  box-shadow: 0 -4px 12px rgba(237, 137, 54, 0.3) !important; // 상단에만 그림자 (주황색 기반)
  padding: $floating-button-padding-vertical $floating-button-padding-horizontal 0 !important; // 상수 사용
  padding-bottom: 0 !important; // 하단 패딩 명시적 제거
  overflow: hidden !important; // 오버플로우 숨김
  clip-path: inset(0 0 0 0) !important; // 클리핑 경로로 하단 완전 제거
  font-size: $floating-button-font-size !important; // 폰트 크기 (상수 사용)
  font-weight: var(--font-weight-semibold) !important;
  font-family: var(--font-family-greeting) !important; // 인사말과 같은 폰트 (Noto Sans KR)
  border-radius: 0 !important; // 기본 border-radius 제거
  border-top-left-radius: 12px !important; // 상단 왼쪽 모서리 라운드
  border-top-right-radius: 12px !important; // 상단 오른쪽 모서리 라운드
  border-bottom-left-radius: 0 !important; // 하단 왼쪽 모서리는 직각 유지
  border-bottom-right-radius: 0 !important; // 하단 오른쪽 모서리는 직각 유지
  // transition을 필요한 속성에만 제한 (bottom, position, transform 제외하여 레이아웃 시프트 방지)
  transition: background-color 0.3s ease, box-shadow 0.3s ease !important;
  z-index: 1000 !important;
  transform: none !important; // transform 완전 제거 (레이아웃 시프트 방지)
  will-change: auto !important; // 레이아웃 시프트 최소화
  box-sizing: border-box !important; // 패딩 포함 전체 너비 계산
  margin: 0 !important; // 모든 마진 제거
  margin-bottom: 0 !important; // 하단 마진 완전 제거
  
  // 하단 하얀 줄 완전 제거 - 모든 의사 요소
  &::after,
  &::before {
    display: none !important;
    content: none !important;
    background: none !important;
    background-color: transparent !important;
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
    height: 0 !important;
    width: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
    box-shadow: none !important;
    outline: none !important;
  }
  
  // Button 컴포넌트의 기본 스타일 오버라이드
  &.button--primary,
  &.button--medium {
    border-radius: 0 !important;
    border-top-left-radius: 12px !important;
    border-top-right-radius: 12px !important;
    border-bottom-left-radius: 0 !important;
    border-bottom-right-radius: 0 !important;
    padding: 0.75rem 1rem 0 !important; // 하단 패딩 제거
    padding-bottom: 0 !important; // 하단 패딩 명시적 제거
    border: none !important;
    border-bottom: none !important;
  }
  
  // button__content span 스타일 - 하단 흰줄 완전 제거
  .button__content {
    margin: 0 !important;
    padding: 0 !important;
    padding-bottom: 0 !important;
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    border-left: none !important;
    border-right: none !important;
    background: transparent !important;
    background-color: transparent !important;
    display: block !important;
    line-height: 1 !important;
    height: auto !important;
    outline: none !important;
    box-shadow: none !important;
    
    &::after,
    &::before {
      display: none !important;
      content: none !important;
      background: none !important;
      background-color: transparent !important;
      border: none !important;
      border-top: none !important;
      border-bottom: none !important;
      border-left: none !important;
      border-right: none !important;
      height: 0 !important;
      width: 0 !important;
      padding: 0 !important;
      margin: 0 !important;
      box-shadow: none !important;
      outline: none !important;
    }
  }
  
  // 버튼 하단 완전 제거
  &::after {
    display: none !important;
    content: none !important;
    height: 0 !important;
    width: 0 !important;
    border: none !important;
    background: none !important;
    box-shadow: none !important;
  }
  
  // 모든 상태에서 border/outline 완전 제거
  &:focus,
  &:focus-visible,
  &:active,
  &:hover,
  &:visited {
    border: none !important;
    border-bottom: none !important;
    border-top: none !important;
    border-left: none !important;
    border-right: none !important;
    outline: none !important;
    outline-offset: 0 !important;
    box-shadow: 0 -4px 12px rgba(124, 116, 106, 0.3) !important; // 상단에만 그림자 유지
  }
  
  // 브라우저 기본 스타일 완전 제거
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  appearance: none !important;
  
  // 모든 화면 크기에서 동일하게 적용
  @media (max-width: 767px) {
    left: 0 !important;
    right: 0 !important;
    width: 100vw !important;
    max-width: 100vw !important;
    transform: none !important;
    bottom: 0 !important; // 하단에 완전히 붙이기
    margin-bottom: 0 !important; // 모바일에서도 하단 마진 제거
    padding-bottom: 0 !important; // 모바일에서도 하단 패딩 제거
  }
  
  &:hover {
    background-color: #4A3A32 !important; // 호버시 더 진한 색상
    transform: none !important; // transform 완전 제거 (레이아웃 시프트 방지)
    box-shadow: 0 6px 16px rgba(85, 67, 59, 0.4) !important; // 호버시 그림자 강화
  }
  
  &:active {
    transform: none !important; // transform 완전 제거
  }
}

// 결과 트렌드 버튼 스타일
.results-trend-button {
  position: fixed !important;
  bottom: 150px !important; // 종합 분석 버튼 위
  right: 20px !important;
  padding: 10px 15px !important;
  border-radius: 30px !important;
  font-size: 14px !important;
  background: #6A1B9A !important; // 보라색 계열
  color: white !important;
  border: none !important;
  box-shadow: 0 2px 5px rgba(0,0,0,0.2) !important;
  z-index: 1000 !important;
  cursor: pointer !important;
  transition: all 0.3s ease !important;
  
  &:hover {
    background: #4A148C !important; // 더 진한 보라색
    transform: translateY(-2px) !important;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3) !important;
  }
  
  &:active {
    transform: translateY(0) !important;
  }
}

// 종합 분석 버튼 스타일
.comprehensive-analysis-button {
  position: fixed !important;
  bottom: 90px !important; // 플로팅 버튼 위
  right: 20px !important;
  padding: 12px 18px !important;
  border-radius: 30px !important;
  font-size: 15px !important;
  font-weight: 600 !important;
  background: #7c746a !important; // 브랜드 브라운 색상
  color: white !important;
  border: none !important;
  box-shadow: 0 3px 8px rgba(124, 116, 106, 0.3) !important;
  z-index: 1001 !important; // 트렌드 버튼보다 위
  cursor: pointer !important;
  transition: all 0.3s ease !important;
  
  &:hover {
    background: #696158 !important; // 더 진한 브라운
    transform: translateY(-2px) !important;
    box-shadow: 0 5px 12px rgba(124, 116, 106, 0.4) !important;
  }
  
  &:active {
    transform: translateY(0) !important;
  }
}

// 모달 스타일
.modal-overlay {
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  z-index: 50;
  @include flex-center;
  padding: $spacing-md;
  transition: opacity 0.3s ease;
}

.modal-content {
  background: #fdf8e2; // 베이지 톤 배경
  width: 100%;
  max-width: 448px; // max-w-md
  border-radius: $border-radius-2xl;
  box-shadow: $shadow-lg;
  padding: $spacing-xl;
  position: relative;
  transform: scale(1);
  transition: transform 0.3s ease;
  max-height: 90vh;
  overflow-y: auto;
}

.modal-close {
  position: absolute;
  top: $spacing-md;
  right: $spacing-md;
  background: none;
  border: none;
  color: $gray-500;
  cursor: pointer;
  padding: $spacing-xs;
  
  &:hover {
    color: $gray-800;
  }
  
  svg {
    width: 24px;
    height: 24px;
  }
}

.modal-title {
  font-size: $font-2xl;
  font-weight: 700;
  color: $brand-brown;
  margin: 0 0 $spacing-sm 0;
  text-align: center;
}

.modal-subtitle {
  font-size: $font-sm;
  color: $gray-600;
  margin: 0 0 $spacing-xl 0;
  text-align: center;
}

.form-fields {
  margin-bottom: $spacing-xl;
  text-align: left;
}

.gender-options {
  display: flex;
  gap: $spacing-md;
}

.gender-option {
  display: flex;
  align-items: center;
  cursor: pointer;
  
  input[type="radio"] {
    margin-right: $spacing-sm;
    accent-color: $brand-brown;
  }
}

// 모달 결과
.modal-result {
  text-align: center;
}

.loader-container {
  @include flex-center;
  margin: $spacing-2xl 0;
}

.loader {
  border: 4px solid #f3f3f3;
  border-top: 4px solid $brand-brown;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.result-text {
  text-align: left;
  font-size: $font-sm;
  background: rgba(255, 255, 255, 0.8);
  padding: $spacing-md;
  border-radius: $border-radius-lg;
  min-height: 150px;
  white-space: pre-wrap;
  margin: $spacing-lg 0;
}

.result-disclaimer {
  font-size: $font-xs;
  color: $gray-500;
  text-align: center;
  margin: $spacing-md 0 0 0;
}

// 병원명 강조 스타일
.hospital-name {
  color: $brand-brown; // 기존 정의된 브랜드 브라운 색상 사용
  font-size: 1.1em; // 폰트 크기 +1 (상대적으로 10% 크게)
  font-weight: 600; // 약간 두껍게
}

// 반응형 조정
@include respond-to(md) {
  .main-container {
    margin: 0;
    border-radius: 0;
  }
  
  .header {
    &__content {
      padding: $spacing-lg $spacing-2xl;
    }
  }
  
  .main-content {
    padding: $spacing-md $spacing-xl $spacing-xl;
  }
}
