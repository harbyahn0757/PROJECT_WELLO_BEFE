# 검진 추천 페이지 렌더링 구조 (최신 JSON 데이터 기준)

## 제공된 JSON 데이터 기준 화면 구성

### 1. 헤더 영역 (고정)
- 환자 이름: "안광수님 건강 상태에 꼭 필요한 검진 항목을 추천드려요!"
- 정보 아이콘: "건강검진 결과 기준 발병확률이 있는 항목을 추천"

---

### 2. 종합 분석 섹션 (최상단)
**데이터**: `gptResponse.analysis`

**표시 내용**:
```
종합 분석

안광수님은 2021년 검진에서 혈압이 140/90으로 측정되어 고혈압 진단 기준에 정확히 해당하는 상태입니다...
[강조 텍스트: 혈압 수치는 심뇌혈관질환의 주요 위험 인자]
[강조 텍스트: 높은 스트레스 수준이 혈압 상승을 유지하거나 악화시킬 수 있는 주요 요인]
[강조 텍스트: 가족력에 심장질환이 있다는 점과 과거 흡연 이력]
[강조 텍스트: 미래의 심혈관 질환 예방에 매우 중요]
```

**참고 자료** (하단):
- 7개의 URL 링크 표시

**주요 사항은 아래와 같아요** (종합 분석 하단):
```
주요 사항은 아래와 같아요

이번 검진에서 주의 깊게 보실 항목은 [혈압측정] [혈액검사] 이에요

추가적으로 [심전도 검사(12유도 심전도)] [복부 초음파] [24시간 홀터 심전도] [심혈관 질환 유전자 검사] 검사로 심혈관 건강 및 복부 장기 건강, 심혈관 건강을(를) 더 확인해보시는게 좋을거 같아요
```
*참고: priority_2.health_context = "심혈관 건강 및 복부 장기 건강", priority_3.health_context = "심혈관 건강"이 합쳐져서 표시됨*

---

### 3. 문진 반영 내용 (아코디언 - 기본 접힘)
**데이터**: `gptResponse.survey_reflection`

**표시 내용**:
```
[▼] 문진 반영 내용

문진 내용을 종합 분석하여 검진 설계에 다음과 같이 반영했습니다...
[강조 텍스트: 높은 스트레스 수준]
[강조 텍스트: 규칙적인 운동(주 3회 이상)을 하고 있음에도 불구하고 스트레스가 높다]
[강조 텍스트: 가족력에 심장질환이 있다]
[강조 텍스트: 과거 흡연 이력]
```

---

### 4. 일반검진, 이 부분은 잘 보세요 (아코디언 - 기본 접힘)
**데이터**: `gptResponse.basic_checkup_guide`

**표시 내용**:
```
[▼] 일반검진, 이 부분은 잘 보세요

일반검진 결과지를 확인하실 때, 안광수님의 상황에서는 아래 항목들을 특히 잘 살펴보시길 바랍니다.

[항목 1] 혈압(최고/최저)
  왜 중요한지: 2021년 검진에서 140/90으로 측정되어 고혈압 진단 기준에 해당했습니다...
  확인 포인트: 특히 가족력에 심장질환이 있고, 문진에서 스트레스 수준이 높다고 응답하셨으므로...

[항목 2] 혈액검사(콜레스테롤, 중성지방)
  왜 중요한지: 혈압이 높은 상태에서는 콜레스테롤과 중성지방 수치도 함께 확인해야 합니다...
  확인 포인트: 과거에는 정상이었지만, 문진에서 운동을 규칙적으로 하신다고 하셨음에도...
```

---

### 5. 선택하신 항목 분석 (아코디언 - 기본 접힘, "1개" 뱃지)
**데이터**: `gptResponse.selected_concerns_analysis`

**표시 내용**:
```
[▼] 선택하신 항목 분석 [1개]

[항목 1] 건강검진
  추이 분석: 2021년 9월 28일 이루탄메디케어의원에서 받은 검진에서 혈압이 140/90으로 측정되었습니다...
  검진 설계 반영: 사용자가 건강검진 전체를 염려 항목으로 선택한 것은 과거 검진에서...
  관련 검진 항목: [혈압측정] [혈액검사] [심전도 검사] [24시간 홀터 심전도]
```

---

### 6. 이번 검진시 유의 깊게 보실 항목이에요 (1순위) - 기본 펼침
**데이터**: `recommendationData.summary.priority_1`

**섹션 헤더**:
```
이번 검진시 유의 깊게 보실 항목이에요 [2개]
```

**우선순위 카드** (기본 펼침):
```
[▼] 관리하실 항목이에요 [2개]

일반검진 결과지를 확인하실 때, 특히 주의 깊게 살펴보시면 좋을 항목들입니다...

관리하실 항목이에요:
[혈압측정] [혈액검사]

[간호사 일러스트]
일반검진 결과지를 확인하실 때, 이 이유 때문에 잘 살펴보시길 바랍니다. 과거 검진에서...
```

**카테고리별 상세 항목** (기본 접힘):
```
[▼] 혈압 및 심전도 검사 [2개]
  [의사 추천 박스]
  안광수님의 경우 과거 검진에서 혈압이 이미 고혈압 기준에 해당했으므로...
  
  [▼] 혈압측정
    심장이 혈액을 내보낼 때의 압력(수축기)과 심장이 확장될 때의 압력(이완기)을 측정하는 검사입니다.
    추천 이유: 일반검진 결과지를 확인하실 때, 이 이유 때문에 잘 살펴보시길 바랍니다...
    의학적 근거: 대한고혈압학회 2018년 진료지침에 따르면...
    참고 자료: [링크1] [링크2]
  
  [▼] 혈액검사(콜레스테롤, 중성지방)
    총 콜레스테롤, 중성지방, 고밀도 콜레스테롤(HDL), 저밀도 콜레스테롤(LDL) 등...
```

---

### 7. 추천검진 항목 (2순위, 3순위) - 기본 펼침
**데이터**: `recommendationData.summary.priority_2`, `priority_3`

**섹션 헤더**:
```
추천검진 항목 [4개]
```

**2순위 우선순위 카드** (기본 펼침):
```
[▼] 병원 추천 검진 항목 [2개]

병원에서 추천하는 특화 검진 항목입니다...

[심전도 검사(12유도 심전도)] [복부 초음파]
```

**2순위 카테고리별 상세 항목** (기본 접힘):
```
[▼] 심혈관 정밀 검진 [2개]
  [의사 추천 박스]
  안광수님은 과거 검진에서 혈압이 고혈압 기준에 해당했고...
  
  [▼] 12유도 심전도
    심장의 전기적 활동을 12개 방향에서 측정하여...
  
  [▼] 24시간 홀터 심전도
    (priority_3으로 분류됨)

[▼] 복부 장기 정밀 검진 [1개]
  [의사 추천 박스]
  안광수님의 경우 고혈압 상태에서 신장 기능을 평가하는 것이 중요하며...
  
  [▼] 복부 초음파
    초음파를 이용하여 간, 담낭, 신장, 췌장, 비장 등...
```

**3순위 섹션 헤더**:
```
이 검사도 고민해보세요 [2개]
```

**3순위 우선순위 카드** (기본 펼침):
```
[▼] 선택 검진 항목 [2개]

선택적으로 받을 수 있는 검진 항목으로...

[24시간 홀터 심전도] [심혈관 질환 유전자 검사]
```

**3순위 카테고리별 상세 항목** (기본 접힘):
```
[▼] 심혈관 정밀 검진 [2개]
  (24시간 홀터 심전도 포함 - priority_3으로 분류됨)

[▼] 유전자 검사 [1개]
  [의사 추천 박스]
  안광수님의 가족력에 심장질환이 있고...
  
  [▼] 심혈관 질환 유전자 검사
    심혈관 질환 관련 유전자 변이를 검사하여...
```

---

## 주요 사항 요약 섹션 (종합 분석 하단)

**표시 내용**:
```
주요 사항은 아래와 같아요

이번 검진에서 주의 깊게 보실 항목은 [혈압측정] [혈액검사] 이에요

추가적으로 [심전도 검사(12유도 심전도)] [복부 초음파] [24시간 홀터 심전도] [심혈관 질환 유전자 검사] 검사로 심혈관 건강 및 복부 장기 건강, 심혈관 건강을(를) 더 확인해보시는게 좋을거 같아요
```

**health_context 처리**:
- priority_2.health_context = "심혈관 건강 및 복부 장기 건강"
- priority_3.health_context = "심혈관 건강"
- 두 값을 합칠 때: "심혈관 건강"이 중복되므로 → "심혈관 건강 및 복부 장기 건강, 심혈관 건강"
- 또는 중복 제거 로직에 따라 → "심혈관 건강 및 복부 장기 건강" (더 나은 결과)

---

## 렌더링 순서 요약

1. **종합 분석** (텍스트 블록 + 요약 섹션)
2. **문진 반영 내용** (아코디언 - 접힘)
3. **일반검진 가이드** (아코디언 - 접힘)
4. **선택하신 항목 분석** (아코디언 - 접힘, 1개 뱃지)
5. **이번 검진시 유의 깊게 보실 항목이에요** (섹션 헤더 + 1순위 카드 - 펼침)
   - 1순위 우선순위 카드 (펼침)
   - 1순위 카테고리별 상세 항목들 (접힘)
6. **추천검진 항목** (섹션 헤더)
   - 2순위 우선순위 카드 (펼침)
   - 2순위 카테고리별 상세 항목들 (접힘)
   - 3순위 섹션 헤더
   - 3순위 우선순위 카드 (펼침)
   - 3순위 카테고리별 상세 항목들 (접힘)

---

## 주요 특징

1. **아코디언 간격**: 각 아코디언 카드 간 `$spacing-lg` 간격 적용
2. **기본 상태**:
   - priority_1, priority_2, priority_3: 기본 펼침
   - 하위 카테고리: 기본 접힘
   - 문진 반영, 일반검진 가이드, 선택 항목 분석: 기본 접힘
3. **강조 텍스트**: `{highlight}...{/highlight}` 패턴이 있으면 하이라이트 스타일 적용
4. **의사 추천 박스**: 각 카테고리마다 의사 일러스트와 추천 메시지 표시
5. **참고 자료**: 종합 분석 하단에 URL 링크 목록 표시
6. **health_context**: 모델에서 받은 값을 우선 사용, 중복 제거 후 합침


